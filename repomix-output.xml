This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
public/
  icons/
    boot.svg
  manifest.json
  sw.js
  vite.svg
src/
  assets/
    vue.svg
  components/
    HomePage.vue
    ProfilePage.vue
    SocialPage.vue
  App.vue
  firebase-config.js
  main.js
  style.css
capacitor.config.json
cors.json
index.html
package.json
README.md
vite.config.js
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="public/manifest.json">
{
  "name": "Run It Up App",
  "short_name": "RunItUp",
  "description": "Your PWA Running Tracker powered by Ionic Vue",
  "start_url": "/index.html",
  "display": "standalone",
  "background_color": "#1e3a8a",
  "theme_color": "#1e3a8a",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512x512.maskable.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable"
    }
  ]
}
</file>

<file path="public/sw.js">
const CACHE_NAME = "run-it-up-app-cache-v1";
// List all files your app needs to function offline.
// Ensure these paths are correct relative to the root of your public folder.
const urlsToCache = [
  "/", // Caches the root URL (your index.html when accessed directly)
  "/index.html",
  "/manifest.json",
  "/icons/icon-192x192.png", // Make sure these paths match your manifest
  "/icons/icon-512x512.png",
  "/icons/icon-512x512.maskable.png",
  // Add your CSS, JS, and other critical assets here:
  "/assets/index-xxxxxxxx.js", // Replace with your actual main JS bundle (check your dist folder after build)
  "/assets/index-xxxxxxxx.css", // Replace with your actual main CSS bundle (check your dist folder after build)
  "/icons/boot.svg", // From your App.vue, ensure this path is correct
];

// Install event: caches assets
self.addEventListener("install", (event) => {
  console.log("[Service Worker] Install Event");
  event.waitUntil(
    caches
      .open(CACHE_NAME)
      .then((cache) => {
        console.log("[Service Worker] Caching app shell");
        return cache.addAll(urlsToCache);
      })
      .catch((error) => {
        console.error("[Service Worker] Failed to cache:", error);
      })
  );
});

// Activate event: cleans up old caches
self.addEventListener("activate", (event) => {
  console.log("[Service Worker] Activate Event");
  const cacheWhitelist = [CACHE_NAME];
  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames.map((cacheName) => {
          if (cacheWhitelist.indexOf(cacheName) === -1) {
            console.log(`[Service Worker] Deleting old cache: ${cacheName}`);
            return caches.delete(cacheName);
          }
        })
      );
    })
  );
});

// Fetch event: serves cached assets or fetches from network
self.addEventListener("fetch", (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      // Cache hit - return response
      if (response) {
        return response;
      }
      // No cache hit - fetch from network
      return fetch(event.request);
    })
  );
});
</file>

<file path="public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>

<file path="src/assets/vue.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="37.07" height="36" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 198"><path fill="#41B883" d="M204.8 0H256L128 220.8L0 0h97.92L128 51.2L157.44 0h47.36Z"></path><path fill="#41B883" d="m0 0l128 220.8L256 0h-51.2L128 132.48L50.56 0H0Z"></path><path fill="#35495E" d="M50.56 0L128 133.12L204.8 0h-47.36L128 51.2L97.92 0H50.56Z"></path></svg>
</file>

<file path="src/components/HomePage.vue">
<template>
  <div class="ion-padding">
    <!-- Overall Stats Card (Redesigned) -->
    <ion-card class="styled-card">
      <ion-card-header>
        <ion-card-title>All-Time Stats</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-grid class="summary-stats-grid">
          <ion-row>
            <ion-col size="6" class="summary-stat-item">
              <ion-icon :icon="rocket" color="primary"></ion-icon>
              <p class="stat-label">Total Distance</p>
              <p class="stat-value small">
                {{ animatedTotalDistance.toFixed(2) }}
                <span class="stat-unit">mi</span>
              </p>
            </ion-col>
            <ion-col size="6" class="summary-stat-item">
              <ion-icon :icon="timeOutline" color="primary"></ion-icon>
              <p class="stat-label">Total Time</p>
              <p class="stat-value small">
                {{ formatTime(animatedTotalTime, true) }}
              </p>
            </ion-col>
          </ion-row>
        </ion-grid>
        <div class="ion-margin-top">
          <div class="level-display">
            <span class="level-emoji">{{ currentLevel.emoji }}</span>
            <span>Level: {{ currentLevel.name }}</span>
            <span style="margin-left: auto; font-size: 1.2rem"
              >{{ Math.floor(animatedXp) }} XP</span
            >
          </div>
          <ion-progress-bar
            :value="progress"
            color="warning"
            class="ion-margin-top"
          ></ion-progress-bar>
          <p class="xp-text">
            Next Level:
            {{ currentLevel.xp === Infinity ? "Max" : currentLevel.xp }}
            XP
          </p>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Reactive Run Button -->
    <ion-card class="styled-card run-action-card">
      <ion-card-content>
        <ion-button
          expand="block"
          class="yellow-button run-button"
          @click="$emit('openRunActionSheet')"
        >
          <ion-icon :icon="walk" slot="start"></ion-icon>
          New Run
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- Weekly Activity Chart (Corrected Layout) -->
    <ion-card class="styled-card">
      <ion-card-header class="weekly-header">
        <ion-card-title>Weekly Activity</ion-card-title>
        <!-- Button container -->
        <div class="week-nav-buttons">
          <ion-button fill="clear" @click="$emit('goToPreviousWeek')">
            <ion-icon slot="icon-only" :icon="chevronBack"></ion-icon>
          </ion-button>
          <ion-button
            fill="clear"
            @click="$emit('goToNextWeek')"
            :disabled="currentWeekOffset === 0"
          >
            <ion-icon slot="icon-only" :icon="chevronForward"></ion-icon>
          </ion-button>
        </div>
      </ion-card-header>

      <ion-card-content>
        <!-- Date is now below the header -->
        <h3 class="week-dates">
          {{ currentWeekStart.toLocaleDateString() }} -
          {{ new Date(currentWeekEnd - 1).toLocaleDateString() }}
        </h3>

        <p class="weekly-total">
          Total: {{ weeklyTotalDistance.toFixed(2) }} mi
        </p>
        <div class="chart-container">
          <!-- Chart Bars -->
          <div
            v-for="data in weeklyChartData"
            :key="data.day"
            class="chart-bar-wrapper"
          >
            <div class="chart-bar" :style="{ height: data.height + '%' }">
              <span v-if="data.distance > 0" class="bar-value">
                {{ data.distance.toFixed(1) }}
              </span>
            </div>
            <p class="chart-label">{{ data.day }}</p>
          </div>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</template>

<script setup>
import {
  IonCard,
  IonCardHeader,
  IonCardTitle,
  IonCardContent,
  IonButton,
  IonIcon,
  IonProgressBar,
  IonGrid,
  IonRow,
  IonCol,
} from "@ionic/vue";
import {
  rocket,
  timeOutline,
  chevronForward,
  chevronBack,
  walk,
} from "ionicons/icons";

defineProps({
  animatedTotalDistance: Number,
  animatedTotalTime: Number,
  animatedXp: Number,
  currentLevel: Object,
  progress: Number,
  formatTime: Function,
  weeklyChartData: Array,
  weeklyTotalDistance: Number,
  currentWeekStart: Date,
  currentWeekEnd: Date,
  currentWeekOffset: Number,
});

defineEmits(["openRunActionSheet", "goToPreviousWeek", "goToNextWeek"]);
</script>

<style scoped>
:deep(.profile-stats-card) {
  --padding-start: 1rem;
  --padding-end: 1rem;
  --padding-top: 1.5rem;
  --padding-bottom: 1.5rem;
}

:deep(.stat-block .stat-title) {
  font-size: 0.8rem;
  color: #d1d5db;
  text-transform: uppercase;
}

:deep(.stat-block .stat-value) {
  font-size: 1.4rem;
  font-weight: 600;
  color: #fff;
}
.styled-card ion-card-title {
  color: #ffffff; /* Explicitly set the title color to white */
}

.run-action-card {
  padding: 8px;
}
.run-button {
  --padding-top: 20px;
  --padding-bottom: 20px;
  font-size: 1.2rem;
}
.summary-stat-item .stat-value.small {
  font-size: 1.5rem;
}

/* Weekly Chart Styles */
.weekly-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.week-nav-buttons {
  display: flex;
  align-items: center;
}
.week-dates {
  color: #ffffff;
  font-size: 1.1em;
  font-weight: 600;
  text-align: center;
  margin: 0 0 0.5rem 0;
}
.weekly-total {
  text-align: center;
  font-size: 1.1em;
  font-weight: 600;
  margin-bottom: 1rem;
  color: #ffffff;
}
.chart-container {
  display: flex;
  justify-content: space-around;
  align-items: flex-end;
  height: 150px;
  padding: 10px 0;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}
.chart-bar-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
  justify-content: flex-end;
}
.chart-bar {
  width: 70%;
  background-color: var(--ion-color-primary);
  border-radius: 4px 4px 0 0;
  transition: height 0.5s ease-out;
  position: relative;
  min-height: 2px;
}
.bar-value {
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 0.8rem;
  color: white;
  opacity: 1;
  transition: opacity 0.3s;
  padding: 2px 4px;
  border-radius: 3px;
}
.chart-label {
  margin-top: 8px;
  font-size: 0.8rem;
  color: var(--ion-color-medium);
}
</style>
</file>

<file path="src/components/ProfilePage.vue">
<template>
  <div class="ion-padding">
    <!-- Main Profile Stats Card -->
    <ion-card class="styled-card profile-stats-card">
      <ion-card-content>
        <div class="profile-header">
          <img
            :src="photoURL || '/default-avatar.png'"
            class="profile-picture-main"
          />
          <div class="profile-info">
            <h2 class="profile-display-name">{{ displayName }}</h2>
            <div class="profile-level">
              <span class="level-icon">{{ currentLevel.emoji }}</span>
              <span>{{ currentLevel.name }} - {{ Math.floor(xp) }} XP</span>
            </div>
          </div>
        </div>
        <ion-progress-bar
          :value="progress"
          color="warning"
          class="ion-margin-vertical"
        ></ion-progress-bar>
        <div class="profile-lifetime-stats">
          <div class="stat-block">
            <p class="stat-title">Total Distance</p>
            <p class="stat-value">{{ totalDistance.toFixed(2) }} mi</p>
          </div>
          <div class="stat-block">
            <p class="stat-title">Total Time</p>
            <p class="stat-value">{{ formatTime(totalTime, true) }}</p>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Shoes Card -->
    <ion-card class="styled-card">
      <ion-card-header>
        <ion-card-title>My Shoes</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none" v-if="userShoes.length > 0">
          <ion-item
            v-for="shoe in userShoes"
            :key="shoe.id"
            button
            @click="$emit('openShoeDetailModal', shoe)"
            class="run-history-item"
          >
            <ion-label>
              <h2>{{ shoe.brandName }}</h2>
              <p>{{ shoe.modelName }}</p>
            </ion-label>
            <ion-note slot="end" class="shoe-mileage-note"
              >{{ shoe.totalDistance.toFixed(2) }} mi</ion-note
            >
          </ion-item>
        </ion-list>
        <p v-else class="ion-text-center no-data-text">
          You haven't added any shoes yet.
        </p>
        <ion-button
          expand="block"
          fill="outline"
          @click="$emit('openAddShoeModal')"
          class="ion-margin-top"
          >Add New Shoe</ion-button
        >
      </ion-card-content>
    </ion-card>

    <!-- Run History Card -->
    <ion-card class="styled-card" v-if="runHistory.length > 0">
      <ion-card-header>
        <ion-card-title>Run History</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          <div
            v-for="(run, index) in displayedRuns"
            :key="run.id"
            class="run-history-item"
          >
            <div class="run-history-header">
              <h2>{{ new Date(run.date).toLocaleDateString() }}</h2>
              <ion-button
                fill="clear"
                color="danger"
                size="small"
                @click="$emit('deleteRun', index)"
              >
                <ion-icon slot="icon-only" :icon="trash"></ion-icon>
              </ion-button>
            </div>
            <p v-if="run.description" class="run-description">
              "{{ run.description }}"
            </p>
            <!-- MAP CONTAINER -->
            <div
              v-if="run.route && run.route.length > 0"
              :ref="(el) => setMapRef('run-' + run.id, el)"
              class="run-card-map"
            ></div>
            <div class="run-history-stats">
              <div>
                <p class="stat-label">Distance</p>
                <p class="stat-value small">
                  {{ run.distance.toFixed(2) }}
                  <span class="stat-unit">mi</span>
                </p>
              </div>
              <div>
                <p class="stat-label">Time</p>
                <p class="stat-value small">
                  {{ formatTime(run.time, true) }}
                </p>
              </div>
              <div>
                <p class="stat-label">Avg Pace</p>
                <p class="stat-value small">
                  {{ formatTime(run.pace) }}
                </p>
              </div>
            </div>

            <div v-if="run.shoeName" class="run-shoe-tag">
              <ion-icon :icon="footsteps"></ion-icon>
              <span>{{ run.shoeName }}</span>
            </div>
            <!-- Run History Shoe Dropdown -->
            <div
              v-else-if="userShoes.length > 0"
              class="add-shoe-to-run-container"
            >
              <ion-item lines="none" class="add-shoe-select-item">
                <ion-select
                  interface="popover"
                  placeholder="Add a shoe"
                  @ionChange="
                    (event) =>
                      $emit('addShoeToPastRun', run, event.detail.value)
                  "
                >
                  <ion-select-option
                    v-for="shoe in userShoes"
                    :key="shoe.id"
                    :value="shoe.id"
                  >
                    {{ shoe.brandName }} {{ shoe.modelName }}
                  </ion-select-option>
                </ion-select>
              </ion-item>
            </div>
          </div>
        </ion-list>
        <ion-button
          v-if="visibleRunsCount < runHistory.length"
          @click="$emit('showMoreRuns')"
          expand="block"
          fill="outline"
          class="ion-margin-top"
          >See More</ion-button
        >
      </ion-card-content>
    </ion-card>
  </div>
</template>

<script setup>
import {
  IonCard,
  IonCardHeader,
  IonCardTitle,
  IonCardContent,
  IonButton,
  IonList,
  IonItem,
  IonLabel,
  IonIcon,
  IonProgressBar,
  IonSelect,
  IonSelectOption,
  IonNote,
} from "@ionic/vue";
import { trash, footsteps } from "ionicons/icons";

defineProps({
  displayName: String,
  photoURL: String,
  currentLevel: Object,
  xp: Number,
  progress: Number,
  totalDistance: Number,
  totalTime: Number,
  formatTime: Function,
  userShoes: Array,
  displayedRuns: Array,
  runHistory: Array,
  visibleRunsCount: Number,
  setMapRef: Function,
});

defineEmits([
  "openShoeDetailModal",
  "openAddShoeModal",
  "deleteRun",
  "addShoeToPastRun",
  "showMoreRuns",
]);
</script>

<style scoped>
/* Profile Page Specific Styles */
.profile-stats-card {
  --padding-start: 1rem;
  --padding-end: 1rem;
  --padding-top: 1.5rem;
  --padding-bottom: 1.5rem;
}

.stat-block .stat-title {
  font-size: 0.8rem;
  color: #d1d5db;
  text-transform: uppercase;
}
.stat-block .stat-value {
  font-size: 1.4rem;
  font-weight: 600;
  color: #fff;
}
/* Shoe Specific Styles */
.run-shoe-tag {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-size: 0.8rem;
  color: #d1d5db;
  margin-top: 8px;
  background-color: rgba(255, 255, 255, 0.1);
  padding: 4px 8px;
  border-radius: 12px;
  width: fit-content;
  margin-left: auto;
  margin-right: auto;
}
.add-shoe-to-run-container {
  display: flex;
  justify-content: center;
  margin-top: 8px;
}
.add-shoe-select-item {
  --background: rgba(255, 255, 255, 0.1);
  --padding-start: 0;
  --inner-padding-end: 0;
  --inner-padding-top: 0;
  --inner-padding-bottom: 0;
  --min-height: unset;
  border-radius: 12px;
  width: fit-content;
}
.add-shoe-select-item ion-select {
  font-size: 0.8rem;
  --padding-start: 8px;
  --padding-end: 8px;
  --padding-top: 4px;
  --padding-bottom: 4px;
  color: #d1d5db;
}
.shoe-mileage-note {
  color: white;
  font-size: 1.1rem;
  font-weight: 600;
}
/* Style for the shoe list items */
.run-history-item ion-label h2 {
  color: #ffffff; /* Ensure brand name is white */
  font-size: 1.1rem; /* Increase font size */
  font-weight: 600;
  margin-bottom: 4px; /* Add a little space between brand and model */
}

.run-history-item ion-label p {
  color: #f0f0f0; /* Change model name from grey to a bright off-white */
  font-size: 0.9rem; /* Increase font size */
}
</style>
</file>

<file path="src/components/SocialPage.vue">
<template>
  <div class="ion-padding">
    <ion-button
      expand="block"
      @click="$emit('openFollowModal')"
      class="ion-margin-bottom yellow-button"
    >
      <ion-icon slot="start" :icon="people"></ion-icon>
      Follow a New User
    </ion-button>

    <div v-if="friends.length > 0" class="friend-list">
      <div
        v-for="friend in sortedFriends"
        :key="friend.uid"
        class="friend-card-refined styled-card"
      >
        <!-- Card Header -->
        <div class="friend-main-info">
          <img
            :src="friend.photoURL || '/default-avatar.png'"
            class="friend-avatar"
            @click="$emit('openUserProfileModal', friend)"
          />
          <div
            class="friend-details"
            @click="$emit('openUserProfileModal', friend)"
          >
            <h2 class="friend-name">{{ friend.displayName }}</h2>
            <div v-if="friend.stats" class="friend-level">
              <span class="level-icon">{{
                getLevelForXp(friend.stats.xp).emoji
              }}</span>
              <span>{{ getLevelForXp(friend.stats.xp).name }}</span>
            </div>
          </div>
          <ion-button
            fill="clear"
            color="danger"
            size="small"
            class="unfollow-button"
            @click="$emit('unfollowUser', friend)"
          >
            <ion-icon slot="icon-only" :icon="trash"></ion-icon>
          </ion-button>
        </div>

        <!-- Progress Bar -->
        <div v-if="friend.stats" class="friend-progress">
          <ion-progress-bar
            :value="getProgressForXp(friend.stats.xp)"
            color="warning"
          ></ion-progress-bar>
        </div>

        <!-- Latest Run -->
        <div class="friend-latest-run">
          <h3 class="section-title">Latest Run</h3>
          <p
            v-if="friend.stats?.lastRun?.date"
            class="latest-run-date-subtitle"
          >
            {{
              new Date(friend.stats.lastRun.date).toLocaleDateString("en-US", {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
              })
            }}
          </p>
          <!-- Run Description -->
          <p
            v-if="
              friend.stats &&
              friend.stats.lastRun &&
              friend.stats.lastRun.description
            "
            class="run-description"
          >
            "{{ friend.stats.lastRun.description }}"
          </p>
          <!-- MAP CONTAINER-->
          <div
            v-if="
              friend.stats?.lastRun?.route &&
              friend.stats.lastRun.route.length > 0
            "
            :ref="(el) => setMapRef('friend-' + friend.uid, el)"
            class="run-card-map"
          ></div>

          <div
            v-if="friend.stats && friend.stats.lastRun"
            class="run-history-stats"
          >
            <div>
              <p class="stat-label">Distance</p>
              <p class="stat-value small">
                {{ friend.stats.lastRun.distance.toFixed(2) }}
                <span class="stat-unit">mi</span>
              </p>
            </div>
            <div>
              <p class="stat-label">Time</p>
              <p class="stat-value small">
                {{ formatTime(friend.stats.lastRun.time, true) }}
              </p>
            </div>
            <div>
              <p class="stat-label">Avg Pace</p>
              <p class="stat-value small">
                {{ formatTime(friend.stats.lastRun.pace) }}
              </p>
            </div>
          </div>

          <div v-else class="ion-text-center">
            <p class="no-data-text">No recent runs</p>
          </div>
        </div>

        <!-- Lifetime Stats -->
        <div class="friend-lifetime-stats">
          <div class="lifetime-stat-item">
            <ion-icon :icon="rocket" class="stat-icon"></ion-icon>
            <span
              >{{
                friend.stats ? friend.stats.totalDistance.toFixed(2) : 0
              }}
              mi</span
            >
          </div>
          <div class="lifetime-stat-item">
            <ion-icon :icon="timeOutline" class="stat-icon"></ion-icon>
            <span>{{
              friend.stats
                ? formatTime(friend.stats.totalTime, true)
                : "00:00:00"
            }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <p v-else class="ion-text-center ion-padding">
      You aren't following anyone yet.
    </p>
  </div>
</template>

<script setup>
import { IonButton, IonIcon, IonProgressBar } from "@ionic/vue";
import { people, trash, rocket, timeOutline } from "ionicons/icons";

defineProps({
  friends: Array,
  sortedFriends: Array,
  formatTime: Function,
  getLevelForXp: Function,
  getProgressForXp: Function,
  setMapRef: Function,
});

defineEmits(["openFollowModal", "openUserProfileModal", "unfollowUser"]);
</script>

<style scoped>
/* Friend Card Specific Styles */
.friend-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.friend-card-refined {
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.friend-main-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.friend-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--ion-color-primary);
  flex-shrink: 0;
  cursor: pointer;
}

.friend-details {
  flex-grow: 1;
  cursor: pointer;
}

.friend-name {
  font-size: 1.2rem;
  font-weight: 700;
  color: #fff;
  margin: 0;
}

.friend-level {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  color: #fbbf24;
}

.level-icon {
  font-size: 1.1rem;
}

.unfollow-button {
  --padding-start: 8px;
  --padding-end: 8px;
  margin-left: auto;
}

.friend-progress {
  width: 100%;
}

.friend-latest-run {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 1rem;
}

.friend-lifetime-stats {
  display: flex;
  justify-content: space-around;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 0.75rem;
}

.lifetime-stat-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  font-weight: 600;
}

.stat-icon {
  color: #fbbf24;
  font-size: 1.2rem;
}

.latest-run-date-subtitle {
  text-align: center;
  font-size: 0.9rem;
  font-weight: 600;
  color: #fbbf24;
  margin-top: 0;
  margin-bottom: 0.75rem;
}
</style>
</file>

<file path="capacitor.config.json">
{
  "appId": "app.runitup",
  "appName": "RunItUp",
  "webDir": "dist"
}
</file>

<file path="cors.json">
[
  {
    "origin": ["*"],
    "method": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    "responseHeader": ["Content-Type", "Access-Control-Allow-Origin"],
    "maxAgeSeconds": 3600
  }
]
</file>

<file path="index.html">
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="theme-color" content="#1E3A8A" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/icons/boot.svg" />

    <link rel="icon" type="image/svg+xml" href="/icons/boot.svg" />
    <title>RunItUp</title>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
</file>

<file path="README.md">
# Vue 3 + Vite

This template should help get you started developing with Vue 3 in Vite. The template uses Vue 3 `<script setup>` SFCs, check out the [script setup docs](https://v3.vuejs.org/api/sfc-script-setup.html#sfc-script-setup) to learn more.

Learn more about IDE Support for Vue in the [Vue Docs Scaling up Guide](https://vuejs.org/guide/scaling-up/tooling.html#ide-support).
</file>

<file path="public/icons/boot.svg">
<svg width="160" height="160" viewBox="0 0 160 160" shape-rendering="geometricPrecision" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<rect x="1" y="1" width="159" height="159" fill="url(#pattern0_1_2)"/>
<defs>
<pattern id="pattern0_1_2" patternContentUnits="objectBoundingBox" width="1" height="1">
<use xlink:href="#image0_1_2" transform="scale(0.000976562)"/>
</pattern>
<image id="image0_1_2" width="1024" height="1024" preserveAspectRatio="none" xlink:href="data:image/png;base64,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AAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABoQAAAAACABgQAAAAAFOrnvAAAACFJREFUaEAAAAAAgAYEAAAAAGhAAAAAAIAGBAAAAABo4P9nCqlRo9yaUQAAAABJRU5ErkJggg=="/>
</defs>
</svg>
</file>

<file path="src/firebase-config.js">
// Import from the full CDN URLs
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { getStorage } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDk-n02q6hW_41tCnLw4oaYYjEh3codxcw",
  authDomain: "runit-91e6f.firebaseapp.com",
  projectId: "runit-91e6f",
  storageBucket: "gs://runit-91e6f.firebasestorage.app",
  messagingSenderId: "1098137720623",
  appId: "1:1098137720623:web:48a6cb82eb37a08fd6b3da",
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

// Initialize and export Firebase services
export const auth = getAuth(app);
export const db = getFirestore(app);
export const storage = getStorage(app);
</file>

<file path="vite.config.js">
// vite.config.js

import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";

// https://vite.dev/config/
export default defineConfig({
  plugins: [vue()],

  server: {
    headers: {
      "Cross-Origin-Opener-Policy": "same-origin-allow-popups",
    },
  },
});
</file>

<file path="package.json">
{
  "name": "runitup-final",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "@capacitor/android": "^7.4.2",
    "@capacitor/cli": "^7.4.2",
    "@capacitor/core": "^7.4.2",
    "@capacitor/haptics": "^7.0.1",
    "@capacitor/ios": "^7.4.2",
    "@ionic/vue": "^8.6.5",
    "gsap": "^3.13.0",
    "ionicons": "^8.0.13",
    "vue": "^3.5.17",
    "vue-router": "^4.5.1"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^6.0.0",
    "vite": "^7.0.4"
  }
}
</file>

<file path="src/main.js">
import { createApp } from "vue";
import App from "./App.vue";

import { IonicVue } from "@ionic/vue";

/* Core CSS required for Ionic components to work properly */
import "@ionic/vue/css/core.css";

/* Basic CSS for apps built with Ionic */
import "@ionic/vue/css/normalize.css";
import "@ionic/vue/css/structure.css";
import "@ionic/vue/css/typography.css";

/* Optional CSS utils that can be commented out */
import "@ionic/vue/css/padding.css";
import "@ionic/vue/css/float-elements.css";
import "@ionic/vue/css/text-alignment.css";
import "@ionic/vue/css/text-transformation.css";
import "@ionic/vue/css/flex-utils.css";
import "@ionic/vue/css/display.css";

/* Theme variables */
import "./style.css"; // Assuming this is your main CSS file, similar to theme/variables.css

const app = createApp(App);

app.use(IonicVue);

// PWA Service Worker Registration
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker
      .register("/sw.js")
      .then((registration) => {
        console.log(
          "Service Worker registered with scope:",
          registration.scope
        );
      })
      .catch((error) => {
        console.log("Service Worker registration failed:", error);
      });
  });
}

document.body.classList.add("dark");

app.mount("#app");
</file>

<file path="src/style.css">
/* Import the Orbitron font */
@import url("https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap");

/*
 * APP'S DEFAULT THEME (Permanently Dark)
 * :root is a global selector for CSS variables.
*/
:root {
  --ion-background-color: #1e3a8a; /* The original deep blue */
  --ion-text-color: #ffffff;
  --ion-color-primary: #3b82f6;
  --ion-color-primary-contrast: #ffffff;
  --ion-toolbar-background: #1e3a8a;
  --ion-color-medium: #d1d5db;
}

/* Apply the default font to the entire app */
body {
  font-family: "Orbitron", sans-serif;
}

/* Your existing component styles (These remain unchanged) */
ion-toolbar {
  --background: rgba(0, 0, 0, 0.2);
  --border-width: 0px;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

ion-card {
  --background: transparent;
}

ion-item {
  --background: transparent;
  --border-color: rgba(255, 255, 255, 0.2);
}

ion-content {
  --background: var(--ion-background-color);
}

/*
 * STYLES FOR ALERT POPUPS (Delete Run, etc.)
*/
.alert-wrapper {
  background-color: #2b499b !important;
}

.alert-title {
  color: #ffffff !important;
}

.alert-message {
  color: #e0e0e0 !important;
}

.alert-button {
  color: #fbbf24 !important;
  font-weight: 600;
}

.alert-button.alert-button-role-destructive {
  color: #ff8a80 !important;
}

/*
 * NEW: STYLES FOR ACTION SHEET POPUPS (New Run, Settings)
 * This uses Ionic CSS variables to theme the component correctly.
*/
.run-action-sheet {
  --backdrop-opacity: 0.6;

  /* Set the background of the action sheet groups */
  --background: #2b499b;

  /* Style the text color of the title */
  --color: #e0e0e0;

  /* Style the individual buttons */
  --button-background: #3b5998; /* A slightly different blue for buttons */
  --button-color: #ffffff;
  --button-background-activated: #4c6aa9; /* For the pressed state */

  /* Style the cancel button specifically */
  --cancel-button-color: #ff8a80;
  --cancel-button-font-weight: bold;
}

/*
 * ANDROID (MATERIAL DESIGN) SPECIFIC POP-UP STYLING
 * Ensures text inside modals and action sheets is light and readable on Android.
*/
.md ion-modal ion-card-title,
.md ion-modal ion-label,
.md ion-modal ion-input,
.md ion-modal p,
.md ion-modal ion-note,
.md ion-modal ion-select {
  color: var(--ion-text-color, #ffffff);
}

.md .run-action-sheet .action-sheet-button,
.md .run-action-sheet .action-sheet-button.action-sheet-cancel {
  color: var(--ion-text-color, #ffffff);
}
</file>

<file path="src/App.vue">
<script setup>
import { ref, computed, onMounted, onUnmounted, nextTick, watch } from "vue";
import {
  IonApp,
  IonHeader,
  IonToolbar,
  IonTitle,
  IonContent,
  IonCard,
  IonCardHeader,
  IonCardTitle,
  IonCardContent,
  IonButton,
  IonInput,
  IonList,
  IonItem,
  IonLabel,
  IonModal,
  IonIcon,
  IonProgressBar,
  alertController,
  toastController,
  IonSpinner,
  IonGrid,
  IonRow,
  IonCol,
  actionSheetController,
  IonActionSheet,
  IonButtons,
  IonSelect,
  IonSelectOption,
  IonNote,
} from "@ionic/vue";
import {
  home,
  people,
  logOut,
  closeCircle,
  trash,
  personCircle,
  rocket,
  timeOutline,
  statsChart,
  speedometer,
  personOutline,
  mailOutline,
  lockClosedOutline,
  settingsOutline,
  footsteps,
  sunnyOutline,
  cloudOutline,
  rainyOutline,
  snowOutline,
  thunderstormOutline,
  partlySunnyOutline,
} from "ionicons/icons";
import { auth, db } from "./firebase-config.js";
import {
  onAuthStateChanged,
  signOut,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  GoogleAuthProvider,
  signInWithPopup,
  fetchSignInMethodsForEmail,
  sendPasswordResetEmail,
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import {
  collection,
  addDoc,
  query,
  where,
  getDocs,
  deleteDoc,
  doc,
  setDoc,
  onSnapshot,
  getDoc,
  orderBy,
  limit,
  updateDoc,
  increment,
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { gsap } from "gsap";
import {
  getStorage,
  ref as storageRef,
  uploadBytes,
  getDownloadURL,
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";
import { storage } from "./firebase-config.js";

// Import the new components
import HomePage from "./components/HomePage.vue";
import SocialPage from "./components/SocialPage.vue";
import ProfilePage from "./components/ProfilePage.vue";

// --- NEW: Input Validation and Sanitization Utilities ---
const validators = {
  isValidEmail: (email) => {
    const re =
      /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
  },
  isStrongPassword: (password) => {
    // Minimum 8 characters, at least one letter and one number
    const re = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;
    return re.test(password);
  },
  sanitizeInput: (input) => {
    const div = document.createElement("div");
    div.textContent = input;
    return div.innerHTML;
  },
};

// --- Helper to display toasts ---
async function presentToast(message, color = "warning") {
  const toast = await toastController.create({
    message,
    duration: 3000,
    color,
    position: "top",
  });
  await toast.present();
}

// --- Ref for IonContent to attach scroll listener ---
const contentRef = ref(null);

// --- STATE ---
const isLoading = ref(true);
const levels = [
  { name: "Bronze", emoji: "", xp: 25 },
  { name: "Silver", emoji: "", xp: 50 },
  { name: "Gold", emoji: "", xp: 100 },
  { name: "Platinum", emoji: "", xp: 200 },
  { name: "Emerald", emoji: "", xp: 400 },
  { name: "Sapphire", emoji: "", xp: 800 },
  { name: "Ruby", emoji: "", xp: 1600 },
  { name: "Diamond", emoji: "", xp: 3200 },
  { name: "Onyx", emoji: "", xp: 6400 },
  { name: "Obsidian", emoji: "", xp: 12800 },
  { name: "Mythic", emoji: "", xp: 25600 },
  { name: "Legendary", emoji: "", xp: Infinity },
];
const user = ref(null);
const email = ref("");
const password = ref("");
const authMessage = ref("");
const totalDistance = ref(0);
const totalTime = ref(0);
const xp = ref(0);
const animatedTotalDistance = ref(0);
const animatedTotalTime = ref(0);
const animatedXp = ref(0);
const distanceInput = ref(null);
const hoursInput = ref(null);
const minutesInput = ref(null);
const secondsInput = ref(null);
const runHistory = ref([]);
const isAuthModalVisible = ref(false);
const currentPage = ref("home");
const displayName = ref("");
const friendUsername = ref("");
const friends = ref([]);
let activeListeners = [];
const visibleRunsCount = ref(2);
const isFollowModalVisible = ref(false);
const isTracking = ref(false);
let watchId = null;
let startTime = null;
let lastPosition = null;
const currentDistance = ref(0);
const currentPace = ref(0);
const elapsedTime = ref(0);
let timerInterval = null;
const routeCoordinates = ref([]);
const isSummaryModalVisible = ref(false);
const lastRunSummary = ref(null);
const photoURL = ref(null);
const newDisplayName = ref("");
const fileInput = ref(null);
const authView = ref("signin");
const isLogRunModalVisible = ref(false);
const isLiveTrackingModalVisible = ref(false);
const currentWeekOffset = ref(0);
const isEditingProfile = ref(false);
const isEditProfileModalVisible = ref(false);
const isUserProfileModalVisible = ref(false);
const selectedFriendProfile = ref(null);
const isFetchingFriendRuns = ref(false);
// State for hold-to-stop button
const isHoldingStop = ref(false);
const holdProgress = ref(0);
let holdTimer = null;
let progressInterval = null;

// --- NEW SHOE FEATURE STATE ---
const userShoes = ref([]);
const isAddShoeModalVisible = ref(false);
const newShoeBrand = ref("");
const newShoeModel = ref("");
const isShoeDetailModalVisible = ref(false);
const selectedShoeDetails = ref(null);
const selectedShoeForRun = ref(null);

// -- DESCRIPTIONS STATE --
const runSummaryDescription = ref("");
const logRunDescription = ref("");

// -- MAPS STATE --
const mapContainer = ref(null); // To get a reference to the div
let map = null; // We use 'let' because the map instance itself isn't reactive
let userMarker = null;
let routePolyline = null;
const summaryMapContainer = ref(null);
let summaryMap = null;
let summaryRoutePolyline = null;
const mapRefs = ref({});
let activeCardMaps = [];
const MAPBOX_ACCESS_TOKEN =
  "pk.eyJ1Ijoia29yeW1idWNrIiwiYSI6ImNtZXJheHJveTA0a3Aya3B4Y3JndGthN2MifQ.2qaE0m-37OvguYab1jiLmA";

// --- COMPUTED ---
const setMapRef = (key, el) => {
  if (el) {
    // This function will initialize the map
    const initialize = () => {
      // Find the route data associated with this map key
      const type = key.startsWith("run-") ? "run" : "friend";
      const id = key.substring(type.length + 1);
      let routeData = null;

      if (type === "run") {
        const run = runHistory.value.find((r) => r.id === id);
        if (run) routeData = run.route;
      } else if (type === "friend") {
        const friend = friends.value.find((f) => f.uid === id);
        if (friend) routeData = friend.stats?.lastRun?.route;
      }

      // If we have data and the map isn't already there, create it
      if (routeData && routeData.length > 0 && !el._leaflet_id) {
        initRunCardMap(el, routeData);
      }
    };

    // The ResizeObserver is the key. It waits for the element to have a size.
    const observer = new ResizeObserver((entries) => {
      for (let entry of entries) {
        // As soon as the container has a width, we know it's visible.
        if (entry.contentRect.width > 0) {
          initialize();
          // Once the map is initialized, we don't need to observe it anymore.
          observer.unobserve(el);
        }
      }
    });

    observer.observe(el);
  }
};

const currentLevel = computed(() => {
  for (let i = 0; i < levels.length; i++) {
    if (xp.value <= levels[i].xp) return { ...levels[i], index: i };
  }
  return levels[levels.length - 1];
});
const nextLevel = computed(
  () => levels[Math.min(currentLevel.value.index + 1, levels.length - 1)]
);
const progress = computed(() => {
  const prevLevel = levels[currentLevel.value.index - 1] || { xp: 0 };
  return currentLevel.value.xp === Infinity
    ? 1
    : (xp.value - prevLevel.xp) / (currentLevel.value.xp - prevLevel.xp);
});
const displayedRuns = computed(() =>
  runHistory.value.slice(0, visibleRunsCount.value)
);
const lastRunXp = computed(() =>
  lastRunSummary.value ? Math.floor(lastRunSummary.value.distance) : 0
);

const getStartOfWeek = (date, offset = 0) => {
  const d = new Date(date);
  d.setDate(d.getDate() - d.getDay() + offset * 7); // Go to Sunday of the offset week
  d.setHours(0, 0, 0, 0);
  return d;
};

const currentWeekStart = computed(() =>
  getStartOfWeek(new Date(), currentWeekOffset.value)
);

const currentWeekEnd = computed(() => {
  const end = new Date(currentWeekStart.value);
  end.setDate(end.getDate() + 7);
  return end;
});

const runsForCurrentWeek = computed(() =>
  runHistory.value.filter((run) => {
    const runDate = new Date(run.timestamp);
    return runDate >= currentWeekStart.value && runDate < currentWeekEnd.value;
  })
);

const weeklyChartData = computed(() => {
  const days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  const dailyTotals = Array(7).fill(0);

  runsForCurrentWeek.value.forEach((run) => {
    const dayIndex = new Date(run.timestamp).getDay();
    dailyTotals[dayIndex] += run.distance;
  });

  const maxDistance = Math.max(...dailyTotals, 1);

  return days.map((day, index) => ({
    day,
    distance: dailyTotals[index],
    height: (dailyTotals[index] / maxDistance) * 100,
  }));
});

const weeklyTotalDistance = computed(() =>
  runsForCurrentWeek.value.reduce((sum, run) => sum + run.distance, 0)
);

const averagePaceInSelectedShoe = computed(() => {
  if (
    !selectedShoeDetails.value ||
    !selectedShoeDetails.value.totalDistance ||
    selectedShoeDetails.value.totalDistance === 0
  ) {
    return 0;
  }
  return (
    selectedShoeDetails.value.totalTime /
    selectedShoeDetails.value.totalDistance
  );
});

const sortedFriends = computed(() => {
  // Create a shallow copy to avoid mutating the original array
  return [...friends.value].sort((a, b) => {
    const aLastRun = a.stats?.lastRun?.date;
    const bLastRun = b.stats?.lastRun?.date;

    // If 'b' has no last run, it should come after 'a'
    if (!bLastRun) return -1;
    // If 'a' has no last run, it should come after 'b'
    if (!aLastRun) return 1;

    // Sort by the most recent date first (descending order)
    return new Date(bLastRun) - new Date(aLastRun);
  });
});

// --- WATCHERS ---

watch(isLiveTrackingModalVisible, (isNowVisible) => {
  if (isNowVisible) {
    setTimeout(() => {
      initMap();
    }, 200);
  }
});

watch(isSummaryModalVisible, (isNowVisible) => {
  if (isNowVisible) {
    // Apply the same logic for the summary map
    setTimeout(() => {
      initSummaryMap();
    }, 200);
  }
});

// --- METHODS ---
function cleanupListeners() {
  activeListeners.forEach((unsubscribe) => unsubscribe());
  activeListeners = [];
}

function getLevelForXp(friendXp) {
  if (typeof friendXp !== "number") friendXp = 0;
  for (let i = 0; i < levels.length; i++) {
    if (friendXp <= levels[i].xp) return { ...levels[i], index: i };
  }
  return { ...levels[levels.length - 1], index: levels.length - 1 };
}

// New function to calculate progress percentage for any given XP
function getProgressForXp(friendXp) {
  if (typeof friendXp !== "number") friendXp = 0;
  const currentFriendLevel = getLevelForXp(friendXp);
  const prevLevel = levels[currentFriendLevel.index - 1] || { xp: 0 };

  if (currentFriendLevel.xp === Infinity) {
    return 1;
  }

  const xpIntoLevel = friendXp - prevLevel.xp;
  const xpForLevel = currentFriendLevel.xp - prevLevel.xp;

  return xpForLevel > 0 ? xpIntoLevel / xpForLevel : 0;
}
function showMoreRuns() {
  visibleRunsCount.value += 5;
}
function openFollowModal() {
  isFollowModalVisible.value = true;
}
function closeFollowModal() {
  isFollowModalVisible.value = false;
  friendUsername.value = "";
}
function openAuthModal() {
  isAuthModalVisible.value = true;
}
function closeAuthModal() {
  isAuthModalVisible.value = false;
  authMessage.value = "";
}

function formatTime(seconds, includeHours = false) {
  if (!seconds || isNaN(seconds)) return includeHours ? "00:00:00" : "00:00";
  const hrs = Math.floor(seconds / 3600);
  const mins = Math.floor((seconds % 3600) / 60);
  const secs = Math.floor(seconds % 60);
  if (includeHours || hrs > 0) {
    return `${hrs.toString().padStart(2, "0")}:${mins
      .toString()
      .padStart(2, "0")}:${secs.toString().padStart(2, "0")}`;
  }
  return `${mins.toString().padStart(2, "0")}:${secs
    .toString()
    .padStart(2, "0")}`;
}

function calculateDistance(lat1, lon1, lat2, lon2) {
  const R = 3958.8; // Radius of Earth in miles
  const dLat = ((lat2 - lat1) * Math.PI) / 180;
  const dLon = ((lon2 - lon1) * Math.PI) / 180;
  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos((lat1 * Math.PI) / 180) *
      Math.cos((lat2 * Math.PI) / 180) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}

function animateStat(statName, startValue, endValue) {
  gsap.fromTo(
    { value: startValue },
    { value: endValue },
    {
      duration: 1.5,
      ease: "power2.out",
      onUpdate: function () {
        if (statName === "totalDistance")
          animatedTotalDistance.value = this.targets()[0].value;
        if (statName === "totalTime")
          animatedTotalTime.value = this.targets()[0].value;
        if (statName === "xp") animatedXp.value = this.targets()[0].value;
      },
    }
  );
}

function goToPreviousWeek() {
  currentWeekOffset.value--;
}

function goToNextWeek() {
  if (currentWeekOffset.value < 0) {
    currentWeekOffset.value++;
  }
}

async function openRunActionSheet() {
  const actionSheet = await actionSheetController.create({
    header: "New Run",
    cssClass: "run-action-sheet",
    buttons: [
      {
        text: "Start Live Tracking",
        handler: () => {
          isLiveTrackingModalVisible.value = true;
        },
      },
      {
        text: "Log a Past Run",
        handler: () => {
          isLogRunModalVisible.value = true;
        },
      },
      {
        text: "Cancel",
        role: "cancel",
      },
    ],
  });
  await actionSheet.present();
}

async function openSettingsMenu() {
  const actionSheet = await actionSheetController.create({
    header: "Settings",
    cssClass: "run-action-sheet",
    buttons: [
      {
        text: "Edit Profile",
        handler: () => {
          isEditProfileModalVisible.value = true;
        },
      },
      {
        text: "Sign Out",
        role: "destructive",
        handler: handleSignOut,
      },
      {
        text: "Cancel",
        role: "cancel",
      },
    ],
  });
  await actionSheet.present();
}

async function fetchRunsForUser(userId) {
  const runsQuery = query(
    collection(db, "runs"),
    where("userId", "==", userId),
    orderBy("timestamp", "desc"),
    limit(5) // Fetch the 5 most recent runs
  );
  const querySnapshot = await getDocs(runsQuery);
  return querySnapshot.docs.map((d) => ({
    id: d.id,
    ...d.data(),
    timestamp: d.data().timestamp.toDate(),
  }));
}

async function openUserProfileModal(friend) {
  isFetchingFriendRuns.value = true;
  selectedFriendProfile.value = { ...friend, runs: [] };
  isUserProfileModalVisible.value = true;

  try {
    const runs = await fetchRunsForUser(friend.uid);
    if (
      selectedFriendProfile.value &&
      selectedFriendProfile.value.uid === friend.uid
    ) {
      selectedFriendProfile.value.runs = runs;
    }
  } catch (error) {
    console.error("Error fetching friend's runs:", error);
    await presentToast("Could not load runs for this user.", "danger");
  } finally {
    isFetchingFriendRuns.value = false;
  }
}

async function initRunCardMap(container, route) {
  // Guard against re-initialization and ensure container exists.
  if (!container || container._leaflet_id) {
    return;
  }

  const mapboxAccessToken = MAPBOX_ACCESS_TOKEN;
  const routeLatLngs = route.map((p) => [p.lat, p.lng]);

  try {
    const cardMap = L.map(container, {
      zoomControl: false,
      dragging: false,
      touchZoom: false,
      scrollWheelZoom: false,
      doubleClickZoom: false,
      boxZoom: false,
      keyboard: false,
      attributionControl: false, // Keep the UI clean for small cards
    });

    L.tileLayer(
      "https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/tiles/{z}/{x}/{y}?access_token={accessToken}",
      { accessToken: mapboxAccessToken }
    ).addTo(cardMap);

    const polyline = L.polyline(routeLatLngs, {
      color: "#fbbf24",
      weight: 4,
    }).addTo(cardMap);

    // This check is crucial. It ensures we only try to fit the map
    // to the route if the route has actual, valid coordinates.
    if (polyline.getBounds().isValid()) {
      cardMap.fitBounds(polyline.getBounds().pad(0.1));
    }

    activeCardMaps.push(cardMap); // Track map instance for later destruction

    // Final check to ensure size is correct after initialization.
    requestAnimationFrame(() => {
      if (cardMap) cardMap.invalidateSize();
    });
  } catch (error) {
    console.error("Error initializing run card map:", error);
  }
}

function destroyCardMaps() {
  activeCardMaps.forEach((map) => {
    if (map && map.remove) {
      map.remove();
    }
  });
  activeCardMaps = [];
  mapRefs.value = {};
}

/* Weather Methods */
const openWeatherApiKey = ref("0eba5f215da947c9f966707b84cea466");

async function fetchWeatherForRun(latitude, longitude) {
  try {
    const response = await fetch(
      `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${openWeatherApiKey.value}&units=imperial`
    );
    if (!response.ok) {
      throw new Error("Weather data not available");
    }
    const data = await response.json();
    return {
      temp: data.main.temp,
      description: data.weather[0].main, // e.g., "Clouds", "Clear"
    };
  } catch (error) {
    console.error("Error fetching weather:", error);
    return null;
  }
}

// Maps weather descriptions to Ionicons
function getWeatherIcon(description) {
  const iconMap = {
    Thunderstorm: thunderstormOutline,
    Drizzle: rainyOutline,
    Rain: rainyOutline,
    Snow: snowOutline,
    Clear: sunnyOutline,
    Cloudy: cloudOutline,
  };
  return iconMap[description] || partlySunnyOutline; // Default icon for mist, fog, etc.
}

/* Map Methods */

async function initMap() {
  // Guard against re-initialization and ensure container exists.
  if (map || !mapContainer.value) {
    if (!mapContainer.value) {
      console.error("initMap called, but mapContainer div not found!");
    }
    return;
  }

  const mapboxAccessToken = MAPBOX_ACCESS_TOKEN;

  try {
    console.log("Container found. Initializing map...");
    map = L.map(mapContainer.value).setView([51.505, -0.09], 13);
    L.tileLayer(
      "https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/tiles/{z}/{x}/{y}?access_token={accessToken}",
      {
        attribution:
          ' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        accessToken: mapboxAccessToken,
      }
    ).addTo(map);

    // Final check to ensure size is correct after initialization.
    requestAnimationFrame(() => {
      if (map) map.invalidateSize();
    });
  } catch (error) {
    console.error("Error during Leaflet initialization:", error);
  }
}

function destroyMap() {
  // Clean up the map instance when the modal is closed to prevent errors
  if (map) {
    map.remove();
    map = null;
    userMarker = null;
    routePolyline = null;
  }
}

async function initSummaryMap() {
  if (
    summaryMap ||
    !summaryMapContainer.value ||
    !lastRunSummary.value?.route?.length
  ) {
    return;
  }

  const mapboxAccessToken = MAPBOX_ACCESS_TOKEN;

  try {
    summaryMap = L.map(summaryMapContainer.value);
    L.tileLayer(
      "https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/tiles/{z}/{x}/{y}?access_token={accessToken}",
      {
        attribution:
          ' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        accessToken: mapboxAccessToken,
      }
    ).addTo(summaryMap);

    const routeLatLngs = lastRunSummary.value.route.map((p) => [p.lat, p.lng]);
    const polyline = L.polyline(routeLatLngs, {
      color: "#fbbf24",
      weight: 6.5,
    }).addTo(summaryMap);

    summaryMap.fitBounds(polyline.getBounds().pad(0.1));

    requestAnimationFrame(() => {
      if (summaryMap) summaryMap.invalidateSize();
    });
  } catch (error) {
    console.error("Error during summary map initialization:", error);
  }
}

function destroySummaryMap() {
  // Clean up the summary map instance when its modal is closed
  if (summaryMap) {
    summaryMap.remove();
    summaryMap = null;
    summaryRoutePolyline = null;
  }
}

// --- SHOE METHODS ---
async function fetchUserShoes(userId) {
  const q = query(
    collection(db, "shoes"),
    where("userId", "==", userId),
    orderBy("brandName")
  );
  try {
    const querySnapshot = await getDocs(q);
    userShoes.value = querySnapshot.docs.map((d) => ({
      id: d.id,
      ...d.data(),
    }));
  } catch (error) {
    console.error("Error fetching user shoes:", error);
  }
}

async function addShoe() {
  const brand = newShoeBrand.value.trim();
  const model = newShoeModel.value.trim();

  // --- VALIDATION START ---
  if (!brand || !model) {
    return presentToast("Please enter both a brand and a model.");
  }
  if (brand.length > 50 || model.length > 50) {
    return presentToast("Brand and model names must be under 50 characters.");
  }
  const sanitizedBrand = validators.sanitizeInput(brand);
  const sanitizedModel = validators.sanitizeInput(model);
  // --- VALIDATION END ---

  try {
    await addDoc(collection(db, "shoes"), {
      userId: user.value.uid,
      brandName: sanitizedBrand,
      modelName: sanitizedModel,
      totalDistance: 0,
      totalTime: 0,
      runCount: 0,
    });
    await fetchUserShoes(user.value.uid);
    isAddShoeModalVisible.value = false;
    newShoeBrand.value = "";
    newShoeModel.value = "";
    await presentToast("Shoe added successfully!", "success");
  } catch (error) {
    console.error("Error adding shoe:", error);
    await presentToast("Could not add shoe. Please try again.", "danger");
  }
}

async function addShoeToPastRun(run, shoeId) {
  if (!run || !shoeId || !user.value) return;

  const runDocRef = doc(db, "runs", run.id);
  const shoeDocRef = doc(db, "shoes", shoeId);

  try {
    const shoeInfo = userShoes.value.find((s) => s.id === shoeId);
    if (!shoeInfo) {
      console.error("Selected shoe not found in local state.");
      return presentToast("Error: Selected shoe could not be found.", "danger");
    }

    // 1. Update the run document to link the shoe
    await updateDoc(runDocRef, {
      shoeId: shoeId,
      shoeName: `${shoeInfo.brandName} ${shoeInfo.modelName}`,
    });

    // 2. Atomically update the shoe's total stats
    await updateDoc(shoeDocRef, {
      totalDistance: increment(run.distance),
      totalTime: increment(run.time),
      runCount: increment(1),
    });

    // 3. Refresh local data to instantly update the UI
    await fetchUserRuns(user.value.uid);
    await fetchUserShoes(user.value.uid);

    await presentToast("Shoe added to your run!", "success");
  } catch (error) {
    console.error("Error adding shoe to past run:", error);
    await presentToast(
      "Failed to add shoe to the run. Please try again.",
      "danger"
    );
  }
}

function openShoeDetailModal(shoe) {
  selectedShoeDetails.value = shoe;
  isShoeDetailModalVisible.value = true;
}

async function updateRunAndShoeStats(runId, runData, shoeId) {
  if (!runId || !runData || !shoeId) return;

  const runDocRef = doc(db, "runs", runId);
  const shoeDocRef = doc(db, "shoes", shoeId);

  try {
    const shoeInfo = userShoes.value.find((s) => s.id === shoeId);
    if (!shoeInfo) {
      console.error("Selected shoe not found in local state.");
      return;
    }

    // 1. Update the run document with shoe information
    await updateDoc(runDocRef, {
      shoeId: shoeId,
      shoeName: `${shoeInfo.brandName} ${shoeInfo.modelName}`,
    });

    // 2. Update the shoe's aggregated stats
    const shoeDoc = await getDoc(shoeDocRef);
    if (shoeDoc.exists()) {
      const currentStats = shoeDoc.data();
      const newStats = {
        totalDistance: (currentStats.totalDistance || 0) + runData.distance,
        totalTime: (currentStats.totalTime || 0) + runData.time,
        runCount: (currentStats.runCount || 0) + 1,
      };
      await updateDoc(shoeDocRef, newStats);
    }

    // 3. Refresh local shoe data to reflect changes immediately on the profile page
    await fetchUserShoes(user.value.uid);

    await presentToast("Run logged to your shoe!", "success");
  } catch (error) {
    console.error("Error updating run and shoe stats:", error);
    await presentToast("Failed to log run to shoe.", "danger");
  }
}

// --- SUMMARY MODAL UPDATE METHODS ---
async function handleSummaryModalDismiss() {
  const runId = lastRunSummary.value?.id;
  const shoeId = selectedShoeForRun.value;
  let description = runSummaryDescription.value.trim();

  // Save shoe info if selected
  if (shoeId && runId) {
    await updateRunAndShoeStats(runId, lastRunSummary.value, shoeId);
  }

  // --- VALIDATION & SANITIZATION for description ---
  if (description) {
    if (description.length > 500) {
      await presentToast("Description must be under 500 characters.");
      // Don't close the modal if validation fails
      return;
    }
    description = validators.sanitizeInput(description);
  }
  // --- END VALIDATION ---

  // Save description if entered
  if (description && runId) {
    try {
      const runDocRef = doc(db, "runs", runId);
      await updateDoc(runDocRef, { description });

      // Update local state for immediate UI feedback
      const runIndex = runHistory.value.findIndex((r) => r.id === runId);
      if (runIndex > -1) {
        runHistory.value[runIndex].description = description;
        // If it's the latest run, update stats which includes the description
        if (runIndex === 0) {
          await updateUserStatsInFirestore();
        }
      }
      await presentToast("Description saved!", "success");
    } catch (error) {
      console.error("Error saving run description:", error);
      await presentToast("Could not save description.", "danger");
    }
  }

  // Reset state and close modal
  isSummaryModalVisible.value = false;
  selectedShoeForRun.value = null;
  runSummaryDescription.value = "";
  destroySummaryMap();
}

// --- WORKOUT METHODS ---
function startWorkout() {
  if (navigator.vibrate) {
    navigator.vibrate(50);
  }
  if (!isTracking.value && navigator.geolocation) {
    isTracking.value = true;
    startTime = Date.now();
    elapsedTime.value = 0;
    currentDistance.value = 0;
    lastPosition = null;
    routeCoordinates.value = [];

    timerInterval = setInterval(() => {
      elapsedTime.value = Math.floor((Date.now() - startTime) / 1000);
    }, 1000);

    watchId = navigator.geolocation.watchPosition(
      (position) => {
        const { latitude, longitude } = position.coords;
        const latlng = [latitude, longitude];

        routeCoordinates.value.push({ lat: latitude, lng: longitude });
        if (lastPosition) {
          const dist = calculateDistance(
            lastPosition.latitude,
            lastPosition.longitude,
            latitude,
            longitude
          );
          currentDistance.value += dist;
        }
        lastPosition = { latitude, longitude };
        currentPace.value =
          currentDistance.value > 0
            ? elapsedTime.value / currentDistance.value
            : 0;

        // --- MAP UPDATE LOGIC ---
        if (map) {
          if (!userMarker) {
            // First time getting location: create marker, polyline, and center map
            userMarker = L.marker(latlng).addTo(map);
            routePolyline = L.polyline([latlng], {
              color: "#fbbf24",
              weight: 6.5,
            }).addTo(map);
            map.setView(latlng, 16); // Zoom in on the user
          } else {
            // Subsequent updates: move marker and extend polyline
            userMarker.setLatLng(latlng);
            routePolyline.addLatLng(latlng);
            map.panTo(latlng); // Smoothly move the map to keep the marker in view
          }
        }
      },
      (error) => {
        alert("Geolocation error: " + error.message);
        stopWorkout();
      },
      { enableHighAccuracy: true, maximumAge: 0, timeout: 15000 }
    );
  } else if (!navigator.geolocation) {
    alert("Geolocation is not supported by this browser.");
  }
}

async function stopWorkout() {
  if (navigator.vibrate) {
    navigator.vibrate(50);
  }
  clearInterval(timerInterval);
  if (watchId) {
    navigator.geolocation.clearWatch(watchId);
  }
  isTracking.value = false;
  isLiveTrackingModalVisible.value = false;

  if (currentDistance.value > 0.0) {
    if (!user.value) {
      alert("Please log in to save your workout data.");
      return;
    }
    let weatherData = null;
    if (lastPosition) {
      weatherData = await fetchWeatherForRun(
        lastPosition.latitude,
        lastPosition.longitude
      );
    }
    const workoutTime = elapsedTime.value;
    const newRunData = {
      userId: user.value.uid,
      date: new Date().toISOString(),
      distance: currentDistance.value,
      time: workoutTime,
      pace: currentDistance.value > 0 ? workoutTime / currentDistance.value : 0,
      timestamp: new Date(),
      route: routeCoordinates.value,
      weather: weatherData,
    };
    try {
      const docRef = await addDoc(collection(db, "runs"), newRunData);
      await fetchUserRuns(user.value.uid);
      lastRunSummary.value = { id: docRef.id, ...newRunData };
      isSummaryModalVisible.value = true;
    } catch (error) {
      console.error("Error saving run:", error);
      await presentToast("There was an error saving your run.", "danger");
    }
  }
  currentDistance.value = 0;
  currentPace.value = 0;
  lastPosition = null;
  startTime = null;
}

async function logRun() {
  if (navigator.vibrate) navigator.vibrate(50);
  if (!user.value) return presentToast("Please log in.", "danger");

  // --- VALIDATION START ---
  const dist = parseFloat(distanceInput.value);
  const timeInSeconds =
    (parseInt(hoursInput.value) || 0) * 3600 +
    (parseInt(minutesInput.value) || 0) * 60 +
    (parseInt(secondsInput.value) || 0);
  let description = logRunDescription.value.trim();

  if (isNaN(dist) || dist <= 0 || dist > 200) {
    return presentToast("Please enter a valid distance (0-200 miles).");
  }
  if (isNaN(timeInSeconds) || timeInSeconds <= 0 || timeInSeconds > 86400) {
    return presentToast("Please enter a valid time (up to 24 hours).");
  }
  if (description) {
    if (description.length > 500) {
      return presentToast("Description must be under 500 characters.");
    }
    description = validators.sanitizeInput(description);
  }
  // --- VALIDATION END ---

  const newRunData = {
    userId: user.value.uid,
    date: new Date().toISOString(),
    distance: dist,
    time: timeInSeconds,
    pace: timeInSeconds / dist,
    timestamp: new Date(),
    description: description,
  };
  try {
    const docRef = await addDoc(collection(db, "runs"), newRunData);

    if (selectedShoeForRun.value) {
      await updateRunAndShoeStats(
        docRef.id,
        newRunData,
        selectedShoeForRun.value
      );
    }
    await fetchUserRuns(user.value.uid);

    // Clear inputs on success
    distanceInput.value = null;
    hoursInput.value = null;
    minutesInput.value = null;
    secondsInput.value = null;
    logRunDescription.value = "";
    selectedShoeForRun.value = null;
    isLogRunModalVisible.value = false;
    await presentToast("Run logged successfully!", "success");
  } catch (error) {
    console.error("Error logging run:", error);
    await presentToast("There was an error logging your run.", "danger");
  }
}

async function deleteRun(index) {
  if (navigator.vibrate) navigator.vibrate(50);
  if (!user.value) return;

  const alert = await alertController.create({
    header: "Confirm Deletion",
    cssClass: "custom-alert",
    message:
      "Are you sure you want to delete this run? This action cannot be undone.",
    buttons: [
      { text: "Cancel", role: "cancel" },
      {
        text: "Delete",
        role: "destructive",
        handler: async () => {
          const runToDelete = runHistory.value[index];
          if (runToDelete.id) {
            try {
              // STEP 1: If a shoe is linked, update its stats by subtracting the run's data.
              if (runToDelete.shoeId) {
                const shoeDocRef = doc(db, "shoes", runToDelete.shoeId);
                // Use Firebase's `increment` with negative values to atomically subtract.
                await updateDoc(shoeDocRef, {
                  totalDistance: increment(-runToDelete.distance),
                  totalTime: increment(-runToDelete.time),
                  runCount: increment(-1),
                });
              }

              // STEP 2: Delete the actual run document.
              await deleteDoc(doc(db, "runs", runToDelete.id));

              // STEP 3: Refresh local data to reflect changes in the UI.
              await fetchUserRuns(user.value.uid); // Recalculates user's total stats.
              await fetchUserShoes(user.value.uid); // Refreshes shoe list with updated mileage.

              await presentToast("Run deleted successfully.", "success");
            } catch (error) {
              console.error(
                "Error deleting run and updating shoe stats:",
                error
              );
              await presentToast(
                "Failed to delete run. Please try again.",
                "danger"
              );
            }
          }
        },
      },
    ],
  });

  await alert.present();
}

// Hold To Stop Button Methods

function startHoldStop() {
  if (isHoldingStop.value) return; // Prevent multiple triggers
  isHoldingStop.value = true;
  holdProgress.value = 0;

  const holdDuration = 2000; // 2 seconds
  const intervalDuration = 10; // Update progress smoothly

  // Set a timeout that will trigger the actual stopWorkout function
  holdTimer = setTimeout(() => {
    stopWorkout();
    // Reset the state after the action is complete
    isHoldingStop.value = false;
    holdProgress.value = 0;
    clearInterval(progressInterval);
  }, holdDuration);

  // Set an interval to update the visual progress bar
  progressInterval = setInterval(() => {
    holdProgress.value += intervalDuration / holdDuration;
    if (holdProgress.value >= 1) {
      clearInterval(progressInterval);
    }
  }, intervalDuration);
}

function cancelHoldStop() {
  // If the user lets go before 2 seconds, clear the timers
  clearTimeout(holdTimer);
  clearInterval(progressInterval);
  holdTimer = null;
  progressInterval = null;
  isHoldingStop.value = false;

  // Animate the progress bar back to 0 for a smooth visual effect
  gsap.to(
    { value: holdProgress.value },
    {
      value: 0,
      duration: 0.3,
      onUpdate: function () {
        holdProgress.value = this.targets()[0].value;
      },
    }
  );
}

// --- FIREBASE METHODS --
async function handleSignIn() {
  authMessage.value = "";
  // --- VALIDATION START ---
  if (!validators.isValidEmail(email.value)) {
    return (authMessage.value = "Please enter a valid email address.");
  }
  if (!password.value) {
    return (authMessage.value = "Please enter your password.");
  }
  // --- VALIDATION END ---

  try {
    await signInWithEmailAndPassword(auth, email.value, password.value);
    // Successful sign-in, onAuthStateChanged will handle UI updates.
  } catch (error) {
    console.error("Sign-in error:", error.code, error.message);

    // This is the key logic: check for the specific error code.
    if (error.code === "auth/invalid-credential") {
      try {
        // If the credential is bad, check what methods ARE available for this email.
        const methods = await fetchSignInMethodsForEmail(auth, email.value);

        // If the array of methods includes 'google.com', we know what's happening.
        if (methods.includes("google.com")) {
          authMessage.value =
            "This email is linked with a Google account. Please use the 'Sign In with Google' button.";
          // Optionally, show a more user-friendly toast notification.
          presentToast(
            "You've previously signed in with Google. Please use that option.",
            "primary"
          );
        } else {
          // If Google is not a method, then it was just a regular wrong password.
          authMessage.value = "Invalid email or password.";
        }
      } catch (fetchError) {
        // This catch handles cases where the email doesn't exist at all.
        console.error("Error fetching sign-in methods:", fetchError);
        authMessage.value = "Invalid email or password.";
      }
    } else {
      // Handle other potential errors (e.g., network issues)
      authMessage.value = `Error signing in: ${error.message}`;
    }
  }
}

async function handleSignUp() {
  authMessage.value = "";

  // --- VALIDATION START ---
  const sanitizedDisplayName = validators.sanitizeInput(
    displayName.value.trim()
  );

  if (!sanitizedDisplayName || !email.value || !password.value) {
    return (authMessage.value = "Please fill out all fields.");
  }
  if (sanitizedDisplayName.length < 3 || sanitizedDisplayName.length > 20) {
    return (authMessage.value =
      "Username must be between 3 and 20 characters.");
  }
  if (!/^[a-zA-Z0-9_]+$/.test(sanitizedDisplayName)) {
    return (authMessage.value =
      "Username can only contain letters, numbers, and underscores.");
  }
  if (!validators.isValidEmail(email.value)) {
    return (authMessage.value = "Please enter a valid email address.");
  }
  if (!validators.isStrongPassword(password.value)) {
    return (authMessage.value =
      "Password must be at least 8 characters long and contain one letter and one number.");
  }
  // --- VALIDATION END ---

  try {
    const userCredential = await createUserWithEmailAndPassword(
      auth,
      email.value,
      password.value
    );
    const newUser = userCredential.user;
    await setDoc(doc(db, "users", newUser.uid), {
      displayName: sanitizedDisplayName, // Use sanitized version
      displayName_lowercase: sanitizedDisplayName.toLowerCase(),
      email: email.value.toLowerCase(),
    });

    //window.location.reload();
  } catch (error) {
    authMessage.value = `Error signing up: ${error.message}`;
  }
}

async function handleSignOut() {
  cleanupListeners();
  await signOut(auth);
}

async function handleForgotPassword() {
  const alert = await alertController.create({
    header: "Reset Password",
    message: "Please enter your email to receive a password reset link.",
    cssClass: "custom-alert", // This uses your existing alert styling
    inputs: [
      {
        name: "email",
        type: "email",
        placeholder: "you@example.com",
      },
    ],
    buttons: [
      {
        text: "Cancel",
        role: "cancel",
      },
      {
        text: "Send",
        handler: async (data) => {
          const email = data.email.trim();
          if (!email || !validators.isValidEmail(email)) {
            presentToast("Please enter a valid email address.", "danger");
            return false; // Prevents the alert from closing on invalid input
          }

          try {
            await sendPasswordResetEmail(auth, email);
            presentToast(
              "Password reset link sent! Check your inbox and spam folder.",
              "success"
            );
          } catch (error) {
            console.error("Password reset error:", error);
            // It's more secure to show a generic message whether the user exists or not.
            presentToast(
              "If an account exists for that email, a reset link has been sent.",
              "warning"
            );
          }
        },
      },
    ],
  });

  await alert.present();
}

async function addFriend() {
  if (!friendUsername.value) {
    return presentToast("Please enter a username.");
  }
  const q = query(
    collection(db, "users"),
    where("displayName_lowercase", "==", friendUsername.value.toLowerCase())
  );
  const querySnapshot = await getDocs(q);
  if (querySnapshot.empty) {
    return presentToast("User not found.", "danger");
  }
  const friendDoc = querySnapshot.docs[0];
  const friendUid = friendDoc.id;
  const friendData = friendDoc.data();
  if (friendUid === user.value.uid) {
    return presentToast("You can't follow yourself.");
  }
  await setDoc(doc(db, `users/${user.value.uid}/friends`, friendUid), {
    displayName: friendData.displayName,
    followedAt: new Date(),
  });

  await presentToast(
    `You are now following ${friendData.displayName}!`,
    "success"
  );

  closeFollowModal();
}

async function unfollowUser(friendToUnfollow) {
  const alert = await alertController.create({
    header: "Unfollow User",
    message: `Are you sure you want to unfollow ${friendToUnfollow.displayName}?`,
    buttons: [
      { text: "Cancel", role: "cancel" },
      {
        text: "Unfollow",
        role: "destructive",
        handler: async () => {
          await deleteDoc(
            doc(db, `users/${user.value.uid}/friends`, friendToUnfollow.uid)
          );
        },
      },
    ],
  });
  await alert.present();
}

async function fetchUserRuns(userId) {
  const q = query(collection(db, "runs"), where("userId", "==", userId));
  const querySnapshot = await getDocs(q);
  runHistory.value = querySnapshot.docs
    .map((d) => ({
      id: d.id,
      ...d.data(),
      timestamp: d.data().timestamp.toDate(),
    }))
    .sort((a, b) => b.timestamp - a.timestamp);
  visibleRunsCount.value = 2;
  await recalculateStatsFromHistory();
}

async function updateUserStatsInFirestore() {
  if (!user.value) return;
  try {
    const lastRun = runHistory.value.length > 0 ? runHistory.value[0] : null;
    const userStatsDocRef = doc(db, "userStats", user.value.uid);
    await setDoc(
      userStatsDocRef,
      {
        totalDistance: totalDistance.value,
        totalTime: totalTime.value,
        xp: xp.value,
        lastRun: lastRun
          ? {
              distance: lastRun.distance,
              time: lastRun.time,
              pace: lastRun.pace,
              date: lastRun.date,
              description: lastRun.description || "",
              route: lastRun.route || null,
            }
          : null,
      },
      { merge: true }
    );
  } catch (error) {
    console.error("Error updating user stats:", error);
  }
}

async function recalculateStatsFromHistory() {
  const oldTotalDistance = totalDistance.value;
  const oldTotalTime = totalTime.value;
  const oldXp = xp.value;
  let newTotalDistance = 0;
  let newTotalTime = 0;
  if (runHistory.value.length > 0) {
    newTotalDistance = runHistory.value.reduce(
      (acc, run) => acc + run.distance,
      0
    );
    newTotalTime = runHistory.value.reduce((acc, run) => acc + run.time, 0);
  }
  totalDistance.value = newTotalDistance;
  totalTime.value = newTotalTime;
  xp.value = newTotalDistance;
  animateStat("totalDistance", oldTotalDistance, totalDistance.value);
  animateStat("totalTime", oldTotalTime, totalTime.value);
  animateStat("xp", oldXp, xp.value);
  await updateUserStatsInFirestore();
}

function setupSocialListeners() {
  cleanupListeners(); // Clean up old listeners before starting new ones
  if (!user.value) return;

  const q = query(collection(db, `users/${user.value.uid}/friends`));
  const mainUnsubscribe = onSnapshot(q, (snapshot) => {
    snapshot.docChanges().forEach((change) => {
      const friendUid = change.doc.id;
      const friendData = change.doc.data();

      if (change.type === "added") {
        const statsDocRef = doc(db, "userStats", friendUid);
        // Add the stats listener's unsubscribe function to our array
        const statsUnsubscribe = onSnapshot(statsDocRef, (statsDoc) => {
          const statsData = statsDoc.data() || {
            totalDistance: 0,
            totalTime: 0,
            xp: 0,
            lastRun: null,
          };
          const existingFriendIndex = friends.value.findIndex(
            (f) => f.uid === friendUid
          );
          if (existingFriendIndex > -1) {
            friends.value[existingFriendIndex].stats = statsData;
          } else {
            friends.value.push({
              uid: friendUid,
              displayName: friendData.displayName,
              stats: statsData,
            });
          }
        });
        activeListeners.push(statsUnsubscribe); // Track it!

        const userDocRef = doc(db, "users", friendUid);
        // Add the user data listener's unsubscribe function to our array
        const userUnsubscribe = onSnapshot(userDocRef, (userDoc) => {
          const userData = userDoc.data();
          const existingFriendIndex = friends.value.findIndex(
            (f) => f.uid === friendUid
          );
          if (existingFriendIndex > -1) {
            friends.value[existingFriendIndex].photoURL = userData.photoURL;
          }
        });
        activeListeners.push(userUnsubscribe); // Track it!
      }

      if (change.type === "removed") {
        friends.value = friends.value.filter((f) => f.uid !== friendUid);
        // Note: For a more robust solution, you'd also want to find and
        // remove the specific listeners for the unfollowed user.
        // But for the logout bug, the global cleanup is sufficient.
      }
    });
  });

  // Also track the main listener itself
  activeListeners.push(mainUnsubscribe);
}

function triggerFileUpload() {
  fileInput.value.click();
}

async function handlePictureUpload(event) {
  const file = event.target.files[0];
  if (!file || !user.value) return;

  // --- VALIDATION START ---
  const allowedTypes = ["image/jpeg", "image/png", "image/gif"];
  if (!allowedTypes.includes(file.type)) {
    return presentToast("Invalid file type. Please upload a JPG, PNG, or GIF.");
  }
  const maxSizeInMB = 5;
  if (file.size > maxSizeInMB * 1024 * 1024) {
    return presentToast(`File is too large. Maximum size is ${maxSizeInMB}MB.`);
  }
  // --- VALIDATION END ---

  const filePath = `profile-pictures/${user.value.uid}`;
  const fileRef = storageRef(storage, filePath);

  try {
    await uploadBytes(fileRef, file);
    const url = await getDownloadURL(fileRef);
    await setDoc(
      doc(db, "users", user.value.uid),
      { photoURL: url },
      { merge: true }
    );
    photoURL.value = url;
    await presentToast("Profile picture updated!", "success");
  } catch (error) {
    console.error("Error uploading picture:", error);
    await presentToast("Failed to upload picture.", "danger");
  }
}

async function updateUsername() {
  const newName = newDisplayName.value.trim();
  // --- VALIDATION START ---
  if (!newName) return;
  if (newName === displayName.value) return;
  if (newName.length < 3 || newName.length > 20) {
    return presentToast("Username must be between 3 and 20 characters.");
  }
  if (!/^[a-zA-Z0-9_]+$/.test(newName)) {
    return presentToast(
      "Username can only contain letters, numbers, and underscores."
    );
  }
  const sanitizedName = validators.sanitizeInput(newName);
  // --- VALIDATION END ---

  const usersRef = collection(db, "users");
  const q = query(
    usersRef,
    where("displayName_lowercase", "==", sanitizedName.toLowerCase())
  );
  const querySnapshot = await getDocs(q);

  if (!querySnapshot.empty) {
    return presentToast(
      "This username is already taken. Please choose another."
    );
  }

  try {
    const userDocRef = doc(db, "users", user.value.uid);
    await setDoc(
      userDocRef,
      {
        displayName: sanitizedName,
        displayName_lowercase: sanitizedName.toLowerCase(),
      },
      { merge: true }
    );

    displayName.value = sanitizedName;
    newDisplayName.value = "";
    isEditProfileModalVisible.value = false;
    await presentToast("Username updated successfully!", "success");
  } catch (error) {
    console.error("Error updating username:", error);
    await presentToast("Failed to update username.", "danger");
  }
}

async function handleGoogleSignIn() {
  authMessage.value = "";
  const provider = new GoogleAuthProvider();
  provider.setCustomParameters({ prompt: "select_account" });

  try {
    const result = await signInWithPopup(auth, provider);
    const user = result.user;

    const userDocRef = doc(db, "users", user.uid);
    const userDoc = await getDoc(userDocRef);

    if (!userDoc.exists()) {
      await setDoc(userDocRef, {
        displayName: user.displayName,
        displayName_lowercase: user.displayName.toLowerCase(),
        email: user.email.toLowerCase(),
        photoURL: user.photoURL,
      });
    }

    // The onAuthStateChanged listener will now handle the UI update automatically.
    // We do NOT need to reload the page here.
  } catch (error) {
    // Add specific checks for common popup errors
    if (error.code === "auth/popup-blocked") {
      authMessage.value =
        "Popup was blocked by the browser. Please allow popups for this site.";
      await presentToast(
        "Popup was blocked by the browser. Please allow popups.",
        "danger"
      );
    } else if (error.code === "auth/popup-closed-by-user") {
      authMessage.value = "Sign-in window was closed before completing.";
      await presentToast("Sign-in cancelled.", "warning");
    } else {
      console.error("Google Sign-In Error:", error);
      authMessage.value = `Error with Google Sign-In: ${error.message}`;
    }
  }
}

// --- Scroll handler for 3D card effect ---
let scrollEl = null;
const handleScroll = () => {
  requestAnimationFrame(() => {
    const cards = document.querySelectorAll(".styled-card");
    const viewportHeight = window.innerHeight;

    cards.forEach((card) => {
      const rect = card.getBoundingClientRect();
      const cardCenterY = rect.top + rect.height / 2;
      const distanceFromCenter = cardCenterY - viewportHeight / 2;
      const rotation = distanceFromCenter / 40;

      card.style.transform = `perspective(800px) rotateX(${rotation}deg)`;
    });
  });
};

// --- LIFECYCLE HOOKS ---
onMounted(() => {
  onAuthStateChanged(auth, async (authUser) => {
    if (authUser) {
      // --- THE FIX ---
      // 1. Close the modal IMMEDIATELY for instant UI feedback.
      closeAuthModal(); // <--- ADD THIS LINE
      isLoading.value = true; // Show the main loading overlay.

      try {
        // 2. Set the user state and fetch all data in the background.
        user.value = authUser;
        const userDoc = await getDoc(doc(db, "users", authUser.uid));
        if (userDoc.exists()) {
          displayName.value = userDoc.data().displayName;
          photoURL.value = userDoc.data().photoURL;
        }

        // Fetch primary data
        await fetchUserRuns(authUser.uid);
        await fetchUserShoes(authUser.uid);

        // Setup listeners and UI effects
        await setupSocialListeners();
        await nextTick();
        if (contentRef.value) {
          scrollEl = await contentRef.value.$el.getScrollElement();
          scrollEl.addEventListener("scroll", handleScroll);
        }
      } catch (error) {
        console.error("Failed to load user data after login:", error);
        await presentToast(
          "There was an error loading your profile.",
          "danger"
        );
      } finally {
        // 3. ALWAYS turn off the loading screen when all operations are complete.
        isLoading.value = false;
      }
    } else {
      // This is the sign-out logic, it remains mostly the same.
      isLoading.value = true;
      user.value = null;
      displayName.value = "";
      photoURL.value = null;
      runHistory.value = [];
      friends.value = [];
      userShoes.value = [];
      recalculateStatsFromHistory();
      cleanupListeners(); // This is from our previous fix
      if (scrollEl) {
        scrollEl.removeEventListener("scroll", handleScroll);
        scrollEl = null;
      }
      openAuthModal();
      isLoading.value = false;
    }
  });
});

onUnmounted(() => {
  if (scrollEl) {
    scrollEl.removeEventListener("scroll", handleScroll);
  }
});
</script>

<template>
  <ion-app>
    <!-- Loading Overlay -->
    <div v-if="isLoading" class="loading-overlay">
      <div class="loading-content">
        <img src="/icons/boot.svg" alt="RunItUp Logo" class="loading-logo" />
        <p>Loading your stats...</p>
        <ion-spinner name="crescent"></ion-spinner>
      </div>
    </div>

    <!-- Main Content -->
    <template v-if="!isLoading">
      <ion-header class="ion-no-border">
        <ion-toolbar>
          <ion-title>RunItUp</ion-title>
          <ion-buttons slot="end">
            <ion-button
              v-if="currentPage === 'profile'"
              @click="openSettingsMenu"
            >
              <ion-icon slot="icon-only" :icon="settingsOutline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content :fullscreen="true" ref="contentRef">
        <img
          v-if="photoURL && currentPage === 'home'"
          :src="photoURL"
          class="page-avatar"
        />
        <div v-if="user" class="ion-text-center ion-margin-bottom">
          <img
            src="/icons/boot.svg"
            alt="RunItUp Logo"
            style="width: 100px; height: auto; margin: auto"
          />
          <p class="ion-margin-top welcome-text">Hello, {{ displayName }}!</p>
        </div>

        <!-- Dynamically render the current page component -->
        <Transition name="fade" mode="out-in">
          <div :key="currentPage">
            <HomePage
              v-if="currentPage === 'home'"
              :animatedTotalDistance="animatedTotalDistance"
              :animatedTotalTime="animatedTotalTime"
              :animatedXp="animatedXp"
              :currentLevel="currentLevel"
              :progress="progress"
              :formatTime="formatTime"
              :weeklyChartData="weeklyChartData"
              :weeklyTotalDistance="weeklyTotalDistance"
              :currentWeekStart="currentWeekStart"
              :currentWeekEnd="currentWeekEnd"
              :currentWeekOffset="currentWeekOffset"
              @open-run-action-sheet="openRunActionSheet"
              @go-to-previous-week="goToPreviousWeek"
              @go-to-next-week="goToNextWeek"
            />

            <SocialPage
              v-if="currentPage === 'social'"
              :friends="friends"
              :sortedFriends="sortedFriends"
              :formatTime="formatTime"
              :getLevelForXp="getLevelForXp"
              :getProgressForXp="getProgressForXp"
              :setMapRef="setMapRef"
              @open-follow-modal="openFollowModal"
              @open-user-profile-modal="openUserProfileModal"
              @unfollow-user="unfollowUser"
            />

            <ProfilePage
              v-if="currentPage === 'profile'"
              :displayName="displayName"
              :photoURL="photoURL"
              :currentLevel="currentLevel"
              :xp="xp"
              :progress="progress"
              :totalDistance="totalDistance"
              :totalTime="totalTime"
              :formatTime="formatTime"
              :userShoes="userShoes"
              :displayedRuns="displayedRuns"
              :runHistory="runHistory"
              :visibleRunsCount="visibleRunsCount"
              :setMapRef="setMapRef"
              @open-shoe-detail-modal="openShoeDetailModal"
              @open-add-shoe-modal="isAddShoeModalVisible = true"
              @delete-run="deleteRun"
              @add-shoe-to-past-run="addShoeToPastRun"
              @show-more-runs="showMoreRuns"
            />
          </div>
        </Transition>

        <!-- Footer Tabs -->
        <div v-if="user" class="footer-tabs">
          <button
            @click="currentPage = 'home'"
            :class="{ active: currentPage === 'home' }"
          >
            <ion-icon :icon="home"></ion-icon>
            <ion-label>Home</ion-label>
          </button>
          <button
            @click="currentPage = 'social'"
            :class="{ active: currentPage === 'social' }"
          >
            <ion-icon :icon="people"></ion-icon>
            <ion-label>Social</ion-label>
          </button>
          <button
            @click="currentPage = 'profile'"
            :class="{ active: currentPage === 'profile' }"
          >
            <ion-icon :icon="personCircle"></ion-icon>
            <ion-label>Profile</ion-label>
          </button>
        </div>
      </ion-content>

      <!-- ALL MODALS REMAIN IN THE PARENT App.vue COMPONENT -->
    </template>
    <ion-modal
      :is-open="isAuthModalVisible"
      :backdrop-dismiss="false"
      class="auth-modal"
    >
      <ion-content class="ion-padding">
        <ion-card class="styled-card auth-card">
          <ion-card-header class="auth-card-header">
            <img src="/icons/boot.svg" alt="RunItUp Logo" class="auth-logo" />
            <ion-card-title>{{
              authView === "signin" ? "Welcome Back" : "Create Account"
            }}</ion-card-title>
          </ion-card-header>

          <ion-card-content>
            <ion-item
              v-if="authView === 'signup'"
              lines="none"
              class="input-with-icon"
            >
              <ion-icon :icon="personOutline" slot="start"></ion-icon>
              <ion-input
                placeholder="Username"
                v-model="displayName"
              ></ion-input>
            </ion-item>

            <ion-item lines="none" class="input-with-icon">
              <ion-icon :icon="mailOutline" slot="start"></ion-icon>
              <ion-input
                placeholder="Email"
                type="email"
                v-model="email"
              ></ion-input>
            </ion-item>

            <ion-item lines="none" class="input-with-icon">
              <ion-icon :icon="lockClosedOutline" slot="start"></ion-icon>
              <ion-input
                placeholder="Password"
                type="password"
                v-model="password"
              ></ion-input>
            </ion-item>

            <p
              v-if="authMessage"
              class="ion-text-center ion-padding-horizontal"
              style="color: var(--ion-color-warning); font-size: 0.9rem"
            >
              {{ authMessage }}
            </p>

            <ion-button
              expand="block"
              @click="authView === 'signin' ? handleSignIn() : handleSignUp()"
              class="ion-margin-top yellow-button"
            >
              {{ authView === "signin" ? "Sign In" : "Create Account" }}
            </ion-button>

            <div class="forgot-password-link">
              <a @click="handleForgotPassword">Forgot Password?</a>
            </div>

            <div class="auth-separator">
              <span>OR</span>
            </div>

            <ion-button
              expand="block"
              @click="handleGoogleSignIn"
              color="light"
              class="ion-margin-top"
            >
              <ion-icon slot="start" src="/assets/google-icon.svg"></ion-icon>
              Sign In with Google
            </ion-button>

            <div class="auth-toggle">
              <p v-if="authView === 'signin'">
                Don't have an account?
                <a @click="authView = 'signup'">Sign Up</a>
              </p>
              <p v-else>
                Already have an account?
                <a @click="authView = 'signin'">Sign In</a>
              </p>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Follow User Modal -->
    <ion-modal
      :is-open="isFollowModalVisible"
      @didDismiss="closeFollowModal()"
      class="auth-modal"
    >
      <ion-content class="ion-padding">
        <ion-card class="styled-card auth-card">
          <ion-card-header class="auth-card-header">
            <ion-button
              fill="clear"
              @click="closeFollowModal()"
              class="modal-close-button"
            >
              <ion-icon slot="icon-only" :icon="closeCircle"></ion-icon>
            </ion-button>
            <ion-card-title>Follow a User</ion-card-title>
          </ion-card-header>

          <ion-card-content>
            <ion-item lines="none" class="input-with-icon">
              <ion-icon :icon="personOutline" slot="start"></ion-icon>
              <ion-input
                placeholder="Enter username to follow"
                v-model="friendUsername"
              ></ion-input>
            </ion-item>

            <ion-button
              expand="block"
              @click="addFriend"
              class="ion-margin-top yellow-button"
            >
              Follow
            </ion-button>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- User Profile Summary Modal -->
    <ion-modal
      :is-open="isUserProfileModalVisible"
      @didDismiss="isUserProfileModalVisible = false"
    >
      <ion-header>
        <ion-toolbar>
          <ion-title v-if="selectedFriendProfile"
            >{{ selectedFriendProfile.displayName }}'s Profile</ion-title
          >
          <ion-buttons slot="end">
            <ion-button @click="isUserProfileModalVisible = false">
              <ion-icon slot="icon-only" :icon="closeCircle"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding" v-if="selectedFriendProfile">
        <!-- Profile Stats Card -->
        <ion-card class="styled-card profile-stats-card">
          <ion-card-content>
            <div class="profile-header">
              <img
                :src="selectedFriendProfile.photoURL || '/default-avatar.png'"
                class="profile-picture-main"
              />
              <div class="profile-info">
                <h2 class="profile-display-name">
                  {{ selectedFriendProfile.displayName }}
                </h2>
                <div class="profile-level" v-if="selectedFriendProfile.stats">
                  <span class="level-icon">{{
                    getLevelForXp(selectedFriendProfile.stats.xp).emoji
                  }}</span>
                  <span
                    >{{ getLevelForXp(selectedFriendProfile.stats.xp).name }}
                    -
                    {{ Math.floor(selectedFriendProfile.stats.xp) }} XP</span
                  >
                </div>
              </div>
            </div>
            <ion-progress-bar
              v-if="selectedFriendProfile.stats"
              :value="getProgressForXp(selectedFriendProfile.stats.xp)"
              color="warning"
              class="ion-margin-vertical"
            ></ion-progress-bar>
            <div
              class="profile-lifetime-stats"
              v-if="selectedFriendProfile.stats"
            >
              <div class="stat-block">
                <p class="stat-title">Total Distance</p>
                <p class="stat-value">
                  {{ selectedFriendProfile.stats.totalDistance.toFixed(2) }}
                  mi
                </p>
              </div>
              <div class="stat-block">
                <p class="stat-title">Total Time</p>
                <p class="stat-value">
                  {{ formatTime(selectedFriendProfile.stats.totalTime, true) }}
                </p>
              </div>
            </div>
          </ion-card-content>
        </ion-card>

        <!-- Recent Runs -->
        <ion-card class="styled-card">
          <ion-card-header>
            <ion-card-title>Recent Runs</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <div v-if="isFetchingFriendRuns" class="ion-text-center">
              <ion-spinner></ion-spinner>
              <p>Loading runs...</p>
            </div>
            <ion-list
              lines="none"
              v-else-if="
                selectedFriendProfile.runs &&
                selectedFriendProfile.runs.length > 0
              "
            >
              <div
                v-for="run in selectedFriendProfile.runs"
                :key="run.id"
                class="run-history-item"
              >
                <div class="run-history-header">
                  <h2>{{ new Date(run.date).toLocaleDateString() }}</h2>
                </div>
                <p v-if="run.description" class="run-description">
                  "{{ run.description }}"
                </p>
                <div class="run-history-stats">
                  <div>
                    <p class="stat-label">Distance</p>
                    <p class="stat-value small">
                      {{ run.distance.toFixed(2) }}
                      <span class="stat-unit">mi</span>
                    </p>
                  </div>
                  <div>
                    <p class="stat-label">Time</p>
                    <p class="stat-value small">
                      {{ formatTime(run.time, true) }}
                    </p>
                  </div>
                  <div>
                    <p class="stat-label">Avg Pace</p>
                    <p class="stat-value small">{{ formatTime(run.pace) }}</p>
                  </div>
                </div>
              </div>
            </ion-list>
            <p v-else class="ion-text-center no-data-text">
              This user has no logged runs yet.
            </p>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Run Summary Modal -->
    <ion-modal
      :is-open="isSummaryModalVisible"
      @didDismiss="handleSummaryModalDismiss"
      class="summary-modal"
    >
      <ion-header>
        <ion-toolbar>
          <ion-title>Run Complete!</ion-title>
          <ion-button
            slot="end"
            fill="clear"
            @click="isSummaryModalVisible = false"
          >
            <ion-icon :icon="closeCircle"></ion-icon>
          </ion-button>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card" v-if="lastRunSummary">
          <!-- Map Summary -->
          <div
            id="summary-map"
            ref="summaryMapContainer"
            v-if="lastRunSummary.route && lastRunSummary.route.length > 0"
          ></div>
          <ion-card-header>
            <img
              src="/icons/boot.svg"
              alt="RunItUp Logo"
              class="summary-logo-icon"
            />
            <ion-card-title class="summary-title"
              >Great Work, {{ displayName }}!</ion-card-title
            >
          </ion-card-header>
          <ion-card-content>
            <div v-if="lastRunSummary.weather" class="weather-summary">
              <ion-icon
                :icon="getWeatherIcon(lastRunSummary.weather.description)"
                class="weather-icon"
              ></ion-icon>

              <span class="weather-temp"
                >{{ Math.round(lastRunSummary.weather.temp) }}&deg;F</span
              >
            </div>
            <ion-grid class="summary-stats-grid">
              <ion-row>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="rocket" color="primary"></ion-icon>
                  <p class="stat-label">Distance</p>
                  <p class="stat-value">
                    {{ lastRunSummary.distance.toFixed(2) }}
                    <span class="stat-unit">mi</span>
                  </p>
                </ion-col>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="timeOutline" color="primary"></ion-icon>
                  <p class="stat-label">Time</p>
                  <p class="stat-value">
                    {{ formatTime(lastRunSummary.time, true) }}
                  </p>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="speedometer" color="primary"></ion-icon>
                  <p class="stat-label">Avg. Pace</p>
                  <p class="stat-value">
                    {{ formatTime(lastRunSummary.pace) }}
                    <span class="stat-unit">/mi</span>
                  </p>
                </ion-col>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="statsChart" color="primary"></ion-icon>
                  <p class="stat-label">XP Gained</p>
                  <p class="stat-value">{{ lastRunXp }}</p>
                </ion-col>
              </ion-row>
            </ion-grid>
            <!-- Run Description Input -->
            <ion-item lines="none" class="input-with-icon ion-margin-top">
              <ion-input
                label="Description"
                label-placement="floating"
                placeholder="(Optional)"
                v-model="runSummaryDescription"
              ></ion-input>
            </ion-item>
            <!-- Shoe Selector Dropdown -->
            <ion-item
              lines="none"
              class="input-with-icon ion-margin-top"
              v-if="userShoes.length > 0"
            >
              <ion-label>Shoe Worn</ion-label>
              <ion-select
                placeholder="Select Shoe"
                v-model="selectedShoeForRun"
              >
                <ion-select-option
                  v-for="shoe in userShoes"
                  :key="shoe.id"
                  :value="shoe.id"
                >
                  {{ shoe.brandName }} {{ shoe.modelName }}
                </ion-select-option>
              </ion-select>
            </ion-item>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Live Tracking Modal -->
    <ion-modal
      :is-open="isLiveTrackingModalVisible"
      @ionModalDidDismiss="destroyMap"
    >
      <ion-header>
        <ion-toolbar>
          <ion-title>Live Run</ion-title>
          <ion-button
            slot="end"
            fill="clear"
            @click="isLiveTrackingModalVisible = false"
          >
            <ion-icon :icon="closeCircle"></ion-icon>
          </ion-button>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card">
          <ion-card-header>
            <ion-card-title>Track a Run</ion-card-title>
          </ion-card-header>
          <div id="map" ref="mapContainer"></div>
          <ion-card-content>
            <ion-button
              v-if="!isTracking"
              expand="block"
              @click="startWorkout"
              class="yellow-button"
              >Start Tracking</ion-button
            >
            <div v-if="isTracking">
              <div class="tracking-stats">
                <div>
                  <p class="tracking-label">DISTANCE</p>
                  <p class="tracking-value">
                    {{ currentDistance.toFixed(2) }} mi
                  </p>
                </div>
                <div>
                  <p class="tracking-label">PACE</p>
                  <p class="tracking-value">
                    {{ formatTime(currentPace) }}
                  </p>
                </div>
                <div>
                  <p class="tracking-label">TIME</p>
                  <p class="tracking-value">
                    {{ formatTime(elapsedTime) }}
                  </p>
                </div>
              </div>
              <!-- Hold to Stop Button -->
              <div
                class="hold-to-stop-button ion-margin-top"
                @mousedown="startHoldStop"
                @mouseup="cancelHoldStop"
                @mouseleave="cancelHoldStop"
                @touchstart.prevent="startHoldStop"
                @touchend="cancelHoldStop"
              >
                <div
                  class="hold-progress"
                  :style="{ transform: `scaleX(${holdProgress})` }"
                ></div>
                <span class="hold-text">HOLD TO STOP</span>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Log Run Modal -->
    <ion-modal :is-open="isLogRunModalVisible">
      <ion-header>
        <ion-toolbar>
          <ion-title>Log a Past Run</ion-title>
          <ion-button
            slot="end"
            fill="clear"
            @click="isLogRunModalVisible = false"
          >
            <ion-icon :icon="closeCircle"></ion-icon>
          </ion-button>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card">
          <ion-card-header>
            <ion-card-title>Log a Run</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <div class="input-group">
              <ion-input
                class="styled-input"
                placeholder="Distance (miles)"
                type="number"
                v-model="distanceInput"
              ></ion-input>
              <div style="display: flex; gap: 8px" class="ion-margin-top">
                <ion-input
                  class="styled-input"
                  placeholder="Hours"
                  type="number"
                  v-model="hoursInput"
                ></ion-input>
                <ion-input
                  class="styled-input"
                  placeholder="Minutes"
                  type="number"
                  v-model="minutesInput"
                ></ion-input>
                <ion-input
                  class="styled-input"
                  placeholder="Seconds"
                  type="number"
                  v-model="secondsInput"
                ></ion-input>
              </div>
            </div>
            <!-- Run Description Input -->
            <ion-item lines="none" class="input-with-icon ion-margin-top">
              <ion-input
                label="Description"
                label-placement="floating"
                placeholder="(Optional)"
                v-model="logRunDescription"
              ></ion-input>
            </ion-item>
            <!-- Shoe Selector Dropdown -->
            <ion-item
              lines="none"
              class="input-with-icon ion-margin-top"
              v-if="userShoes.length > 0"
            >
              <ion-label>Shoe Worn (Optional)</ion-label>
              <ion-select
                placeholder="Select Shoe"
                v-model="selectedShoeForRun"
              >
                <ion-select-option
                  v-for="shoe in userShoes"
                  :key="shoe.id"
                  :value="shoe.id"
                >
                  {{ shoe.brandName }} {{ shoe.modelName }}
                </ion-select-option>
              </ion-select>
            </ion-item>
            <ion-button
              expand="block"
              @click="logRun"
              class="ion-margin-top yellow-button"
              >Log Run</ion-button
            >
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>
    <!-- Profile Settings Dropdown -->
    <ion-modal :is-open="isEditProfileModalVisible">
      <ion-header>
        <ion-toolbar>
          <ion-title>Edit Profile</ion-title>
          <ion-buttons slot="end">
            <ion-button @click="isEditProfileModalVisible = false">
              <ion-icon slot="icon-only" :icon="closeCircle"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card">
          <ion-card-content>
            <ion-list>
              <ion-item lines="none">
                <ion-button
                  expand="block"
                  fill="outline"
                  @click="triggerFileUpload"
                  class="full-width-button"
                >
                  Change Profile Picture
                </ion-button>
                <input
                  type="file"
                  @change="handlePictureUpload"
                  ref="fileInput"
                  style="display: none"
                  accept="image/*"
                />
              </ion-item>
              <ion-item lines="none">
                <ion-input
                  class="styled-input"
                  placeholder="Enter new username"
                  v-model="newDisplayName"
                ></ion-input>
              </ion-item>
              <ion-item lines="none">
                <ion-button
                  expand="block"
                  @click="updateUsername"
                  color="primary"
                  class="full-width-button"
                >
                  Save Username
                </ion-button>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Add Shoe Modal -->
    <ion-modal :is-open="isAddShoeModalVisible">
      <ion-header>
        <ion-toolbar>
          <ion-title>Add a New Shoe</ion-title>
          <ion-buttons slot="end">
            <ion-button @click="isAddShoeModalVisible = false">
              <ion-icon slot="icon-only" :icon="closeCircle"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card">
          <ion-card-content>
            <ion-item lines="none" class="input-with-icon">
              <ion-input
                label="Brand Name"
                label-placement="floating"
                placeholder="e.g., Hoka"
                v-model="newShoeBrand"
              ></ion-input>
            </ion-item>
            <ion-item lines="none" class="input-with-icon">
              <ion-input
                label="Model Name"
                label-placement="floating"
                placeholder="e.g., Clifton 9"
                v-model="newShoeModel"
              ></ion-input>
            </ion-item>
            <ion-button
              expand="block"
              @click="addShoe"
              class="ion-margin-top yellow-button"
              >Save Shoe</ion-button
            >
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>

    <!-- Shoe Detail Modal -->
    <ion-modal
      :is-open="isShoeDetailModalVisible"
      @didDismiss="isShoeDetailModalVisible = false"
      class="summary-modal"
    >
      <ion-header>
        <ion-toolbar>
          <ion-title>Shoe Details</ion-title>
          <ion-button
            slot="end"
            fill="clear"
            @click="isShoeDetailModalVisible = false"
          >
            <ion-icon :icon="closeCircle"></ion-icon>
          </ion-button>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-card class="styled-card" v-if="selectedShoeDetails">
          <ion-card-header>
            <ion-card-title class="summary-title">
              {{ selectedShoeDetails.brandName }}
            </ion-card-title>
            <p class="ion-text-center">{{ selectedShoeDetails.modelName }}</p>
          </ion-card-header>
          <ion-card-content>
            <ion-grid class="summary-stats-grid">
              <ion-row>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="rocket" color="primary"></ion-icon>
                  <p class="stat-label">Total Distance</p>
                  <p class="stat-value">
                    {{ selectedShoeDetails.totalDistance.toFixed(2) }}
                    <span class="stat-unit">mi</span>
                  </p>
                </ion-col>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="timeOutline" color="primary"></ion-icon>
                  <p class="stat-label">Total Time</p>
                  <p class="stat-value">
                    {{ formatTime(selectedShoeDetails.totalTime, true) }}
                  </p>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="speedometer" color="primary"></ion-icon>
                  <p class="stat-label">Avg. Pace</p>
                  <p class="stat-value">
                    {{ formatTime(averagePaceInSelectedShoe) }}
                    <span class="stat-unit">/mi</span>
                  </p>
                </ion-col>
                <ion-col size="6" class="summary-stat-item">
                  <ion-icon :icon="footsteps" color="primary"></ion-icon>
                  <p class="stat-label">Total Runs</p>
                  <p class="stat-value">{{ selectedShoeDetails.runCount }}</p>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-card-content>
        </ion-card>
      </ion-content>
    </ion-modal>
  </ion-app>
</template>

<style>
/* This style block is NOT scoped to affect the entire app background */
@keyframes gradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}
</style>

<style scoped>
/* --- 3D Glassmorphism & Global Styles --- */
ion-header.ion-no-border ion-toolbar {
  --background: transparent;
}

ion-content {
  --background: none;
  background: linear-gradient(-45deg, #1e3a8a, #0c1a4b, #2a4a9c, #1a2a6c);
  background-size: 400% 400%;
  animation: gradient 15s ease infinite;
}

/* This global selector targets all child components */
:deep(.styled-card) {
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.1),
    rgba(255, 255, 255, 0)
  );
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-radius: 24px;
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  transition: transform 0.3s ease;
  margin-bottom: 1.5rem;
}

:deep(.yellow-button) {
  --background: #fbbf24;
  --background-activated: #f59e0b;
  --color: #1a202c;
  --box-shadow: 0 4px 15px -5px rgba(251, 191, 36, 0.6);
  --border-radius: 12px;
  font-weight: 700;
  transform: translateY(0);
  transition: transform 0.2s, box-shadow 0.2s;
}

:deep(.yellow-button:active) {
  transform: translateY(2px);
  --box-shadow: 0 2px 10px -5px rgba(251, 191, 36, 0.8);
}
:deep(.stat-label) {
  color: #d1d5db;
  font-size: 0.8rem;
  text-transform: uppercase;
  margin: 0;
}
:deep(.stat-value) {
  color: #ffffff;
  font-size: 1.2rem;
  font-weight: 700;
  line-height: 1.1;
  margin: 4px 0 0 0;
}
:deep(.stat-unit) {
  font-size: 1.25rem;
  font-weight: 400;
  color: #d1d5db;
}
:deep(.stat-value.small) {
  font-size: clamp(1.2rem, 3.5vw, 1.5rem);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
:deep(.run-history-stats) {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  text-align: center;
  margin-top: 1rem;
}
:deep(.run-description) {
  font-style: italic;
  color: #f0f0f0;
  padding: 10px 14px;
  margin: 10px 0 4px 0;
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  border-radius: 8px;
  border-left: 3px solid #fbbf24;
}
:deep(.run-card-map) {
  height: 150px;
  width: 100%;
  border-radius: 12px;
  margin-bottom: 1rem;
  background-color: #3a4b7a;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.2);
}
:deep(.section-title) {
  font-size: 0.8rem;
  font-weight: 600;
  color: #d1d5db;
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 0.25rem;
  text-align: center;
}

:deep(.styled-card ion-card-title) {
  color: #ffffff !important; /* Use !important to ensure this rule wins */
  font-weight: 600; /* Let's make it a bit bolder too */
}
:deep(.no-data-text) {
  font-style: italic;
  color: var(--ion-color-medium);
  font-size: 0.9rem;
}

/* Shared Level/XP Styles */
:deep(.level-display) {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 1.1rem;
  font-weight: 600;
  color: #fbbf24;
}
:deep(.level-emoji) {
  font-size: 1.5rem;
}
:deep(.xp-text) {
  font-size: 0.8rem;
  color: #d1d5db;
  text-align: right;
  margin-top: 0.5rem;
}
/* Add these new styles inside the <style scoped> tag in src/App.vue */

/* Run Summary Modal Styles */
.summary-logo-icon {
  width: 60px;
  height: auto;
  margin: 0 auto 0.5rem;
  display: block;
}

.summary-title {
  text-align: center;
  font-size: 1.8rem;
  margin-bottom: 1rem;
}

.summary-stats-grid {
  margin-top: 1.5rem;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 1rem;
}

.summary-stat-item {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.summary-stat-item ion-icon {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.weather-summary {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  background: rgba(255, 255, 255, 0.1);
  padding: 8px 12px;
  border-radius: 16px;
  width: fit-content;
  margin: 0 auto 1.5rem auto;
}

.weather-icon {
  font-size: 1.8rem;
  color: #fbbf24; /* Yellow to match theme */
}

.weather-temp {
  font-size: 1.5rem;
  font-weight: 600;
  color: #ffffff;
}

/* Log a Past Run Modal Styles */
.input-group {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.styled-input {
  --background: rgba(255, 255, 255, 0.1);
  --padding-start: 12px;
  --placeholder-color: #d1d5db;
  --color: #ffffff;
  border-radius: 8px;
}

.full-width-button {
  width: 100%;
}

/* Auth Modal Specific Styles (Shared with other modals) */
.auth-card {
  --padding-start: 1rem;
  --padding-end: 1rem;
  --padding-top: 1.5rem;
  --padding-bottom: 1.5rem;
  max-width: 400px;
  margin: auto;
}

.auth-card-header {
  text-align: center;
  padding-bottom: 1rem;
}

.auth-logo {
  width: 80px;
  height: auto;
  margin: 0 auto 1rem;
}

.input-with-icon {
  --background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  margin-bottom: 1rem;
  --padding-start: 12px;
}

.input-with-icon ion-icon {
  margin-right: 8px;
  color: #d1d5db;
}

.auth-separator {
  display: flex;
  align-items: center;
  text-align: center;
  color: #d1d5db;
  margin: 1.5rem 0;
}

.auth-separator::before,
.auth-separator::after {
  content: "";
  flex: 1;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.auth-separator:not(:empty)::before {
  margin-right: 0.5em;
}

.auth-separator:not(:empty)::after {
  margin-left: 0.5em;
}

.auth-toggle {
  text-align: center;
  margin-top: 1.5rem;
  font-size: 0.9rem;
  color: #d1d5db;
}

.auth-toggle a {
  color: #fbbf24;
  font-weight: 600;
  cursor: pointer;
}

.modal-close-button {
  position: absolute;
  top: 8px;
  right: 8px;
  font-size: 1.8rem;
}
:deep(.profile-header) {
  display: flex;
  align-items: center;
  gap: 1rem;
}
:deep(.profile-picture-main) {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--ion-color-primary);
  flex-shrink: 0; /* Prevents the image from shrinking */
}
:deep(.profile-info) {
  flex-grow: 1;
}
:deep(.profile-display-name) {
  font-size: 1.6rem;
  font-weight: 700;
  margin: 0;
  color: #fff;
}
:deep(.profile-level) {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 1rem;
  color: #fbbf24;
  margin-top: 4px;
}
:deep(.profile-lifetime-stats) {
  display: flex;
  justify-content: space-around;
  text-align: center;
  margin-top: 1rem;
}
:deep(.run-history-item) {
  padding-top: 1rem;
  padding-bottom: 1rem;
  /* This border is key to separating the runs */
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  background: transparent;
}
:deep(.run-history-item:last-child) {
  border-bottom: none;
}
:deep(.run-history-header) {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}
:deep(.run-history-item h2) {
  font-weight: 600;
  color: #fbbf24;
  margin: 0;
  font-size: 1.1rem;
}

:deep(.styled-card ion-list) {
  --ion-background-color: transparent;
  background: transparent; /* Fallback for older browsers */
  padding: 0; /* Remove default list padding */
}
/* Footer & Navigation */
.footer-tabs {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  height: 75px;
  background: rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  display: flex;
  justify-content: space-around;
  align-items: center;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: env(safe-area-inset-bottom);
}
.footer-tabs button {
  background: none;
  border: none;
  color: #bbb;
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 12px;
  transition: color 0.2s;
  position: relative;
}
.footer-tabs button.active {
  color: #fbbf24;
  text-shadow: 0 0 10px #fbbf24;
}
.footer-tabs button.active ion-icon {
  animation: bounce 0.5s;
}
@keyframes bounce {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-5px);
  }
}
.footer-tabs ion-icon {
  font-size: 26px;
  margin-bottom: 2px;
}
ion-content {
  --padding-bottom: 80px;
}
.fade-enter-active,
.fade-leave-active {
  transition: all 0.25s ease-out;
}
.fade-enter-from,
.fade-leave-to {
  opacity: 0;
  transform: translateY(10px);
}

/* Other Global Styles */
.welcome-text {
  font-size: 1.2rem;
  font-weight: 600;
  color: #fff;
}
.page-avatar {
  position: absolute;
  top: 65px;
  right: 20px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid var(--ion-color-primary);
  z-index: 10;
  object-fit: cover;
}
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: var(--ion-background-color);
  z-index: 9999;
  flex-direction: column;
}
.loading-content {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-family: "Orbitron", sans-serif;
}
.loading-content p {
  color: var(--ion-text-color);
  font-size: 1.2rem;
  margin-top: 1.5rem;
  margin-bottom: 1.5rem;
}
.loading-logo {
  width: 120px;
  height: auto;
  animation: pulse 2s infinite ease-in-out;
}
ion-spinner {
  width: 50px;
  height: 50px;
  color: var(--ion-color-primary);
}
@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.05);
    opacity: 0.85;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Modal Styles */
.auth-modal,
.summary-modal {
  --background: transparent;
}
.auth-modal ion-content,
.summary-modal ion-content {
  --background: transparent;
}
#map,
#summary-map {
  height: 250px;
  width: auto;
  margin-bottom: 1rem;
  border-radius: 12px;
  margin-left: 16px;
  margin-right: 16px;
}
#summary-map {
  height: 200px;
  margin: 1rem;
}

/* Live Tracking Modal Styles */
.tracking-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  text-align: center;
  margin-top: 1rem;
  margin-bottom: 1.5rem;
}
.tracking-label {
  color: #d1d5db;
  font-size: 0.8rem;
  text-transform: uppercase;
  margin: 0;
}
.tracking-value {
  color: #ffffff;
  font-size: clamp(1.5rem, 5vw, 2rem);
  font-weight: 700;
  line-height: 1.1;
  margin: 4px 0 0 0;
}

/* Hold to Stop Button Styles */
.hold-to-stop-button {
  position: relative;
  width: 100%;
  height: 60px;
  background-color: #ef4444;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  overflow: hidden;
  user-select: none;
  -webkit-user-select: none; /* For Safari */
  box-shadow: 0 4px 15px -5px rgba(239, 68, 68, 0.6);
}
.hold-progress {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background-color: #b91c1c;
  width: 100%;
  transform-origin: left;
  transform: scaleX(0);
}
.hold-text {
  position: relative;
  color: white;
  font-weight: bold;
  font-size: 1.1rem;
  z-index: 1;
}

/* Forgot Password Link */
.forgot-password-link {
  text-align: center; /* Changed from right to center */
  margin-top: 0.25rem;
  margin-bottom: 1.25rem;
}

.forgot-password-link a {
  font-size: 0.9rem; /* Slightly larger for better tapping */
  color: #fbbf24; /* Yellow to match the other links */
  font-weight: 600; /* Bolded to match */
  cursor: pointer;
  text-decoration: none;
  transition: color 0.2s ease-in-out;
}

.forgot-password-link a:hover {
  color: #ffffff; /* Change hover color to white */
}
</style>
</file>

</files>
